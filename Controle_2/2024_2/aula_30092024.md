# Projeto de Controladores

Aula ministrada em 30/09/2024. Continua√ß√£o da [aula de 23/09/2024](aula_23092024.html).

## Embasamento te√≥rico sobre Controladores com A√ß√£o Derivativa

* A√ß√£o Derivativa ([Derivador Puro?](https://fpassold.github.io/Controle_2/Acao_Derivativa.html) Simula√ß√µes, cuidados e aten√ß√£o);
* A√ß√£o Derivativa na presen√ßa de sinal ruidoso ([Aula de 11/11/2022](https://fpassold.github.io/Controle_2/Exemplo_ruido_acao_derivativa/circuito_derivativo.html));
* Teoria √† respeito de Compensador por Avan√ßo de Fase (Lead) ([Aula de 02/06/2021](https://fpassold.github.io/Controle_2/Teoria_PD_Lead/acoes_derivativas.html)).

## Projeto de PD

Recuperando se√ß√£o de trabalho anterior:

```matlab
>> pwd  % verificando pasta atual onde dados est√£o gravados
ans =
    '/Volumes/DADOS/Users/fpassold/Documents/UPF/Controle_2/2024_2'
>> load planta  % carregando dados da se√ß√£o de trabalho anterior
>> diary aula_30092024.txt  % iniciando registro desta aula
```

Lembrando da eq. da planta:

```matlab
>> zpk(G)

          20
  ------------------
  (s+10) (s+4) (s+1)
 
Continuous-time zero/pole/gain model.
```

Eq. gen√©rica do PD:

$C_{PD}(s)=K_p + K_d s = K \left( z + z_{PD}\right)$

onde: $K=$ ganho gen√©rico do controlador (definido com aux√≠lio do RL); $z_{PD}=$ zero do controlador PD -- inc√≥gnita atual. 

Seguem esbo√ßos de RL para diferentes op√ß√µes de locais para o zero do PD. Para ver op√ß√µes (casos semelhantes, recomenda-se verificar o item "[Projeto de PD (Aula de 03/10/2019](https://fpassold.github.io/Controle_2/aula_PD_03out2019.html)").

Op√ß√µes:

* **Op√ßao 1**: $0 < z_{PD} < -1$: mas neste caso teremos um p√≥lo de MF real muito pr√≥ximo do eixo $j\omega$, atrasando muito a resposta do sistema;
* **Op√ß√£o 2**: $-1 < z_{PD} < -4$: resulta um p√≥lo de MF real dominante mais afastado do eixo $j\omega.$ Na pr√°tica, seria a ==melhor op√ß√£o==.
* **Op√ß√£o 3**: $z_{PD}=-4$ (cancelando o 2o-p√≥lo mais lento da planta). Resulta num sistema em MF de 2a-ordem (redu√ß√£o de complexidade do sistema).
* **Op√ß√£o 4**: $z_{PD}= -1$ (cancelando o p√≥lo mais lento da planta). Resulta num sistema em MF de 2a-ordem e mais r√°pido que op√ß√£o 3. Ao menos teoricamente, supondo que os p√≥los estejam realmente em $s=-1$, $s=-4$ e que o sistema n√£o possua n√£o linearidades).

### PD Op√ß√£o 2

Neste caso: $-4 < z_{PD} < -1$. Arbitrando um local gem√©trico intermedi√°rio:

```matlab
>> (1+4)/2
ans =
          2.5

>> PD2 = tf( [1 2.5], 1)

PD2 =
 
  s + 2.5
 
Continuous-time transfer function.

>> ftma_PD2 = PD2*G;
>> zpk(ftma_PD2)

      20 (s+2.5)
  ------------------
  (s+10) (s+4) (s+1)
 
Continuous-time zero/pole/gain model.

>> rlocus(ftma_PD2)
>> hold on; sgrid(zeta,0)
>> [K_PD2,polosMF]=rlocfind(ftma_PD2)
Select a point in the graphics window
selected_point =
      -6.3768 +     8.6378i
K_PD2 =
        4.509
polosMF =
      -6.3444 +     8.6372i
      -6.3444 -     8.6372i
      -2.3112 +          0i
```

Obtemos o RL abaixo, j√° ressaltando pontos de sintonia e outros detalhes:

![RL_PD2.png](RL_PD2.png)

```matlab
ftmf_PD2=feedback(K_PD2*ftma_PD2, 1);   % fechando a malha
figure; step(ftmf_PD2, ftmf)
```

Obtemos a seguinte resposta ao degrau para este PD, comparando sua resposta com controlador Porporcional realizado na [aula de 09/09/2024](aula09092024.html).

![step_PD2.png](step_PD2.png)

**Coment√°rios:**

* Poderia ser aumentado o ganho deste PD, j√° que o $\%OS$ ficou abaixo dos 10% em rela√ß√£o √† entrada degrau (implica $y(t)\vert_{t_p}=1,1$ j√° que a refer√™ncia √© entrada degrau unit√°rio, ent√£o $y(\infty)_{desejado}=1,0$);
* Mas √© mais interessante deslocar o zero do PD para mais pr√≥ximo do p√≥lo da planta em $s = -4$ (revisar RL), o que resultaria num p√≥lo de MF real dominante mais afastado do eixo $j\omega$ (mais r√°pido).

### Projeto do PD (p√ß√£o 4)

O PD mais r√°pido, em teoria, seria obtido fazendo o zero do PD propositalmente cancelar o p√≥lo mais lento da planta em $s=-1$.

```matlab
>> PD4 = tf( [1 1], 1)

PD4 =
 
  s + 1
 
Continuous-time transfer function.

>> ftma_PD4=PD4*G;
>> zpk(ftma_PD4)

       20 (s+1)
  ------------------
  (s+10) (s+4) (s+1)
 
Continuous-time zero/pole/gain model.

>> ftma_PD4aux=minreal(ftma_PD4);
>> zpk(ftma_PD4aux)

       20
  ------------
  (s+10) (s+4)
 
Continuous-time zero/pole/gain model.

>> figure; rlocus(ftma_PD4)
>> hold on; sgrid(zeta,0)
>> ylim([-15 15])   % usando mesmos limites que RL obtido anteriormente (para compara√ß√£o visual)
>> [K_PD4,polosMF]=rlocfind(ftma_PD4)
Select a point in the graphics window
selected_point =
      -7.0071 +     9.5666i
K_PD4 =
        5.026
polosMF =
           -7 +     9.5666i
           -7 -     9.5666i
           -1 +          0i
```

RL obtido para este controlador:

![RL_PD4.png](RL_PD4.png)

```matlab
>> % fechando a malha
>> ftmf_PD4=feedback(K_PD4*ftma_PD4, 1);
>> figure; step(ftmf_PD2, ftmf_PD4)
>> legend('PD2', 'PD4')
```

Resposta em MF para entrada degrau, comparada com PD da op√ß√£o 2:

![step_PD4.png](step_PD4.png)

**Coment√°rios:**

* Pode-se aumentar ainda mais o ganho do PD4, neste caso, acompanhando o que aconteceria no RL, vamos perceber que reduzimos o valor de $t_p$ (parte imagin√°ria dos p√≥los complexos de MF "sobe"), mas $t_s$ se manteria no mesmo valor, j√° que a parte real dos p√≥los de MF n√£o varia de valor. **Mas** o que importa neste caso √© que o erro de regime permante deve ser sensivelmente reduzido (√© o que normalmente acontece quando se eleva o ganho para sistemas tipo 0 -- ver [Teoria do Erro](https://fpassold.github.io/Controle_2/3_erros/erros.pdf));

* Por√©m note que o erro do PD4 √© maior que o erro do PD2. O PD4 pode ser mais r√°pido que o PD2, mas com o ganho `K_PD4` no valor que est√°, resulta num erro muito maior:

  ```matlab
  >> erro_PD4= ((1-dcgain(ftmf_PD4))/1)*100
  erro_PD4 =
         28.466
  >> erro_PD2= ((1-dcgain(ftmf_PD2))/1)*100
  erro_PD2 =
         15.069
  ```

**Observa√ß√£o final**:

Para pr√≥xima aula, a id√©ia √© usar o "**App Control System Desginer**" do Matlab, para facilitar e acelerar o projeto de controladores. Neste caso, podemos melhorar o PD2, testando seu zero mais pr√≥ximo de $s=-4$, para intencionalmente fazer o p√≥lo de MF real dominante se afastar ainda mais do eixo $j\omega$ (menor tempo de resposta, menor $t_s$) e ainda encontrar um valor de ganho elevado que permita fazer $y(\infty)\vert_{t_p} \cong 1,1$ (10% de overshoot em rela√ß√£o √† entrada degrau). E assim estar√≠amos projetando o melhor PD pr√°tico para este tipo de sistema.

Encerrando atividades nesta aula:

```matlab
>> save planta
>> diary off
>> quit
```

---

<font size="2">üåä [Fernando Passold](https://fpassold.github.io/)[ üì¨ ](mailto:fpassold@gmail.com), <script language="JavaScript"><!-- Hide JavaScript...
var LastUpdated = document.lastModified;
document.writeln ("p√°gina criada em 09 Sept 2024; atualizada em " + LastUpdated); // End Hiding -->
</script></font>
