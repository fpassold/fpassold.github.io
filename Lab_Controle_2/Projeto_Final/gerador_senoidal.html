<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>gerador_senoidal.html</title>
  <meta name="generator" content="Haroopad 0.13.1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>div.oembedall-githubrepos{border:1px solid #DDD;border-radius:4px;list-style-type:none;margin:0 0 10px;padding:8px 10px 0;font:13.34px/1.4 helvetica,arial,freesans,clean,sans-serif;width:452px;background-color:#fff}div.oembedall-githubrepos .oembedall-body{background:-moz-linear-gradient(center top,#FAFAFA,#EFEFEF);background:-webkit-gradient(linear,left top,left bottom,from(#FAFAFA),to(#EFEFEF));border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-top:1px solid #EEE;margin-left:-10px;margin-top:8px;padding:5px 10px;width:100%}div.oembedall-githubrepos h3{font-size:14px;margin:0;padding-left:18px;white-space:nowrap}div.oembedall-githubrepos p.oembedall-description{color:#444;font-size:12px;margin:0 0 3px}div.oembedall-githubrepos p.oembedall-updated-at{color:#888;font-size:11px;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats{border:none;float:right;font-size:11px;font-weight:700;padding-left:15px;position:relative;z-index:5;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats li{border:none;color:#666;display:inline-block;list-style-type:none;margin:0!important}div.oembedall-githubrepos ul.oembedall-repo-stats li a{background-color:transparent;border:none;color:#666!important;background-position:5px -2px;background-repeat:no-repeat;border-left:1px solid #DDD;display:inline-block;height:21px;line-height:21px;padding:0 5px 0 23px}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a{border-left:medium none;margin-right:-3px}div.oembedall-githubrepos ul.oembedall-repo-stats li a:hover{background:5px -27px no-repeat #4183C4;color:#FFF!important;text-decoration:none}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a:hover{border-bottom-left-radius:3px;border-top-left-radius:3px}ul.oembedall-repo-stats li:last-child a:hover{border-bottom-right-radius:3px;border-top-right-radius:3px}span.oembedall-closehide{background-color:#aaa;border-radius:2px;cursor:pointer;margin-right:3px}div.oembedall-container{margin-top:5px;text-align:left}.oembedall-ljuser{font-weight:700}.oembedall-ljuser img{vertical-align:bottom;border:0;padding-right:1px}.oembedall-stoqembed{border-bottom:1px dotted #999;float:left;overflow:hidden;width:730px;line-height:1;background:#FFF;color:#000;font-family:Arial,Liberation Sans,DejaVu Sans,sans-serif;font-size:80%;text-align:left;margin:0;padding:0}.oembedall-stoqembed a{color:#07C;text-decoration:none;margin:0;padding:0}.oembedall-stoqembed a:hover{text-decoration:underline}.oembedall-stoqembed a:visited{color:#4A6B82}.oembedall-stoqembed h3{font-family:Trebuchet MS,Liberation Sans,DejaVu Sans,sans-serif;font-size:130%;font-weight:700;margin:0;padding:0}.oembedall-stoqembed .oembedall-reputation-score{color:#444;font-size:120%;font-weight:700;margin-right:2px}.oembedall-stoqembed .oembedall-user-info{height:35px;width:185px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-gravatar32{float:left;height:32px;width:32px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-details{float:left;margin-left:5px;overflow:hidden;white-space:nowrap;width:145px}.oembedall-stoqembed .oembedall-question-hyperlink{font-weight:700}.oembedall-stoqembed .oembedall-stats{background:#EEE;margin:0 0 0 7px;padding:4px 7px 6px;width:58px}.oembedall-stoqembed .oembedall-statscontainer{float:left;margin-right:8px;width:86px}.oembedall-stoqembed .oembedall-votes{color:#555;padding:0 0 7px;text-align:center}.oembedall-stoqembed .oembedall-vote-count-post{font-size:240%;color:#808185;display:block;font-weight:700}.oembedall-stoqembed .oembedall-views{color:#999;padding-top:4px;text-align:center}.oembedall-stoqembed .oembedall-status{margin-top:-3px;padding:4px 0;text-align:center;background:#75845C;color:#FFF}.oembedall-stoqembed .oembedall-status strong{color:#FFF;display:block;font-size:140%}.oembedall-stoqembed .oembedall-summary{float:left;width:635px}.oembedall-stoqembed .oembedall-excerpt{line-height:1.2;margin:0;padding:0 0 5px}.oembedall-stoqembed .oembedall-tags{float:left;line-height:18px}.oembedall-stoqembed .oembedall-tags a:hover{text-decoration:none}.oembedall-stoqembed .oembedall-post-tag{background-color:#E0EAF1;border-bottom:1px solid #3E6D8E;border-right:1px solid #7F9FB6;color:#3E6D8E;font-size:90%;line-height:2.4;margin:2px 2px 2px 0;padding:3px 4px;text-decoration:none;white-space:nowrap}.oembedall-stoqembed .oembedall-post-tag:hover{background-color:#3E6D8E;border-bottom:1px solid #37607D;border-right:1px solid #37607D;color:#E0EAF1}.oembedall-stoqembed .oembedall-fr{float:right}.oembedall-stoqembed .oembedall-statsarrow{background-image:url(http://cdn.sstatic.net/stackoverflow/img/sprites.png?v=3);background-repeat:no-repeat;overflow:hidden;background-position:0 -435px;float:right;height:13px;margin-top:12px;width:7px}.oembedall-facebook1{border:1px solid #1A3C6C;padding:0;font:13.34px/1.4 verdana;width:500px}.oembedall-facebook2{background-color:#627add}.oembedall-facebook2 a{color:#e8e8e8;text-decoration:none}.oembedall-facebookBody{background-color:#fff;vertical-align:top;padding:5px}.oembedall-facebookBody .contents{display:inline-block;width:100%}.oembedall-facebookBody div img{float:left;margin-right:5px}div.oembedall-lanyard{-webkit-box-shadow:none;-webkit-transition-delay:0s;-webkit-transition-duration:.4000000059604645s;-webkit-transition-property:width;-webkit-transition-timing-function:cubic-bezier(0.42,0,.58,1);background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:none;background-origin:padding-box;border-width:0;box-shadow:none;color:#112644;display:block;float:left;font-family:'Trebuchet MS',Trebuchet,sans-serif;font-size:16px;height:253px;line-height:19px;margin:0;max-width:none;min-height:0;outline:#112644 0;overflow-x:visible;overflow-y:visible;padding:0;position:relative;text-align:left;vertical-align:baseline;width:804px}div.oembedall-lanyard .tagline{font-size:1.5em}div.oembedall-lanyard .wrapper{overflow:hidden;clear:both}div.oembedall-lanyard .split{float:left;display:inline}div.oembedall-lanyard .prominent-place .flag:active,div.oembedall-lanyard .prominent-place .flag:focus,div.oembedall-lanyard .prominent-place .flag:hover,div.oembedall-lanyard .prominent-place .flag:link,div.oembedall-lanyard .prominent-place .flag:visited{float:left;display:block;width:48px;height:48px;position:relative;top:-5px;margin-right:10px}div.oembedall-lanyard .place-context{font-size:.889em}div.oembedall-lanyard .prominent-place .sub-place{display:block}div.oembedall-lanyard .prominent-place{font-size:1.125em;line-height:1.1em;font-weight:400}div.oembedall-lanyard .main-date{color:#8CB4E0;font-weight:700;line-height:1.1}div.oembedall-lanyard .first{width:48.57%;margin:0 0 0 2.857%}.mermaid .label{color:#333}.node circle,.node polygon,.node rect{fill:#cde498;stroke:#13540c;stroke-width:1px}.edgePath .path{stroke:green;stroke-width:1.5px}.cluster rect{fill:#cdffb2;rx:40;stroke:#6eaa49;stroke-width:1px}.cluster text{fill:#333}.actor{stroke:#13540c;fill:#cde498}text.actor{fill:#000;stroke:none}.actor-line{stroke:grey}.messageLine0{stroke-width:1.5;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#333}.messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#arrowhead{fill:#333}#crosshead path{fill:#333!important;stroke:#333!important}.messageText{fill:#333;stroke:none}.labelBox{stroke:#326932;fill:#cde498}.labelText,.loopText{fill:#000;stroke:none}.loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#326932}.note{stroke:#6eaa49;fill:#fff5ad}.noteText{fill:#000;stroke:none;font-family:'trebuchet ms',verdana,arial;font-size:14px}.section{stroke:none;opacity:.2}.section0,.section2{fill:#6eaa49}.section1,.section3{fill:#fff;opacity:.2}.sectionTitle0,.sectionTitle1,.sectionTitle2,.sectionTitle3{fill:#333}.sectionTitle{text-anchor:start;font-size:11px;text-height:14px}.grid .tick{stroke:lightgrey;opacity:.3;shape-rendering:crispEdges}.grid path{stroke-width:0}.today{fill:none;stroke:red;stroke-width:2px}.task{stroke-width:2}.taskText{text-anchor:middle;font-size:11px}.taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}.taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}.taskText0,.taskText1,.taskText2,.taskText3{fill:#fff}.task0,.task1,.task2,.task3{fill:#487e3a;stroke:#13540c}.taskTextOutside0,.taskTextOutside1,.taskTextOutside2,.taskTextOutside3{fill:#000}.active0,.active1,.active2,.active3{fill:#cde498;stroke:#13540c}.activeText0,.activeText1,.activeText2,.activeText3{fill:#000!important}.done0,.done1,.done2,.done3{stroke:grey;fill:lightgrey;stroke-width:2}.doneText0,.doneText1,.doneText2,.doneText3{fill:#000!important}.crit0,.crit1,.crit2,.crit3{stroke:#f88;fill:red;stroke-width:2}.activeCrit0,.activeCrit1,.activeCrit2,.activeCrit3{stroke:#f88;fill:#cde498;stroke-width:2}.doneCrit0,.doneCrit1,.doneCrit2,.doneCrit3{stroke:#f88;fill:lightgrey;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}.activeCritText0,.activeCritText1,.activeCritText2,.activeCritText3,.doneCritText0,.doneCritText1,.doneCritText2,.doneCritText3{fill:#000!important}.titleText{text-anchor:middle;font-size:18px;fill:#000}text{font-family:'trebuchet ms',verdana,arial;font-size:14px}html{height:100%}body{margin:0!important;padding:5px 20px 26px!important;background-color:#fff;font-family:"Lucida Grande","Segoe UI","Apple SD Gothic Neo","Malgun Gothic","Lucida Sans Unicode",Helvetica,Arial,sans-serif;font-size:.9em;overflow-x:hidden;overflow-y:auto}br,h1,h2,h3,h4,h5,h6{clear:both}hr.page{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x;border:0;height:3px;padding:0}hr.underscore{border-top-style:dashed!important}body >:first-child{margin-top:0!important}img.plugin{box-shadow:0 1px 3px rgba(0,0,0,.1);border-radius:3px}iframe{border:0}figure{-webkit-margin-before:0;-webkit-margin-after:0;-webkit-margin-start:0;-webkit-margin-end:0}kbd{border:1px solid #aaa;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-moz-box-shadow:1px 2px 2px #ddd;-webkit-box-shadow:1px 2px 2px #ddd;box-shadow:1px 2px 2px #ddd;background-color:#f9f9f9;background-image:-moz-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-o-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-webkit-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:linear-gradient(top,#eee,#f9f9f9,#eee);padding:1px 3px;font-family:inherit;font-size:.85em}.oembeded .oembed_photo{display:inline-block}img[data-echo]{margin:25px 0;width:100px;height:100px;background:url(../img/ajax.gif) center center no-repeat #fff}.spinner{display:inline-block;width:10px;height:10px;margin-bottom:-.1em;border:2px solid rgba(0,0,0,.5);border-top-color:transparent;border-radius:100%;-webkit-animation:spin 1s infinite linear;animation:spin 1s infinite linear}.spinner:after{content:'';display:block;width:0;height:0;position:absolute;top:-6px;left:0;border:4px solid transparent;border-bottom-color:rgba(0,0,0,.5);-webkit-transform:rotate(45deg);transform:rotate(45deg)}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg)}}@keyframes spin{to{transform:rotate(360deg)}}p.toc{margin:0!important}p.toc ul{padding-left:10px}p.toc>ul{padding:10px;margin:0 10px;display:inline-block;border:1px solid #ededed;border-radius:5px}p.toc li,p.toc ul{list-style-type:none}p.toc li{width:100%;padding:0;overflow:hidden}p.toc li a::after{content:"."}p.toc li a:before{content:"• "}p.toc h5{text-transform:uppercase}p.toc .title{float:left;padding-right:3px}p.toc .number{margin:0;float:right;padding-left:3px;background:#fff;display:none}input.task-list-item{margin-left:-1.62em}.markdown{font-family:"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",'Segoe UI',AppleSDGothicNeo-Medium,'Malgun Gothic',Verdana,Tahoma,sans-serif;padding:20px}.markdown a{text-decoration:none;vertical-align:baseline}.markdown a:hover{text-decoration:underline}.markdown h1{font-size:2.2em;font-weight:700;margin:1.5em 0 1em}.markdown h2{font-size:1.8em;font-weight:700;margin:1.275em 0 .85em}.markdown h3{font-size:1.6em;font-weight:700;margin:1.125em 0 .75em}.markdown h4{font-size:1.4em;font-weight:700;margin:.99em 0 .66em}.markdown h5{font-size:1.2em;font-weight:700;margin:.855em 0 .57em}.markdown h6{font-size:1em;font-weight:700;margin:.75em 0 .5em}.markdown h1+p,.markdown h1:first-child,.markdown h2+p,.markdown h2:first-child,.markdown h3+p,.markdown h3:first-child,.markdown h4+p,.markdown h4:first-child,.markdown h5+p,.markdown h5:first-child,.markdown h6+p,.markdown h6:first-child{margin-top:0}.markdown hr{border:1px solid #ccc}.markdown p{margin:1em 0;word-wrap:break-word}.markdown ol{list-style-type:decimal}.markdown li{display:list-item;line-height:1.4em}.markdown blockquote{margin:1em 20px}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown blockquote cite:before{content:'\2014 \00A0'}.markdown .code{border-radius:3px;word-wrap:break-word}.markdown pre{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;overflow:auto;padding:.5em}.markdown pre code{border:0;display:block}.markdown pre>code{font-family:Consolas,Inconsolata,Courier,monospace;font-weight:700;white-space:pre;margin:0}.markdown code{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;padding:0 5px;margin:0 2px}.markdown img{max-width:100%}.markdown mark{color:#000;background-color:#fcf8e3}.markdown table{padding:0;border-collapse:collapse;border-spacing:0;margin-bottom:16px}.markdown table tr td,.markdown table tr th{border:1px solid #ccc;margin:0;padding:6px 13px}.markdown table tr th{font-weight:700}.markdown table tr th>:first-child{margin-top:0}.markdown table tr th>:last-child{margin-bottom:0}.markdown table tr td>:first-child{margin-top:0}.markdown table tr td>:last-child{margin-bottom:0}.clearness{padding:20px;color:#737373;font-size:15px;background:#fff;-webkit-font-smoothing:antialiased}.clearness a{color:#1e6ea7}.clearness a:hover{color:#268bd2}.clearness h1,.clearness h2,.clearness h3,.clearness h4,.clearness h5{color:#404040}.clearness h2{border-bottom:1px solid #ccc;line-height:1.7em}.clearness h6{color:#666}.clearness hr{border:1px solid #e6e6e6}.clearness pre>code{font-size:.9em}.clearness blockquote{padding:0 15px;font-style:italic}.clearness blockquote:before{content:"\201C";font-size:40px;margin-left:-20px;color:#aaa}.clearness table{background-color:#fff;border-collapse:separate;border-spacing:2px}.clearness table tr td,.clearness table tr th{border:0;padding:.2em 1em}.clearness table tr th{border-bottom:1px solid #bfbfbf}.clearness table tr td{border-bottom:1px solid #d9d9d9}.clearness table tr:nth-child(2n){background-color:#fff}.hljs{display:block;overflow-x:auto;padding:.5em;background:#fff;color:#000;-webkit-text-size-adjust:none}.apache .hljs-cbracket,.diff .hljs-header,.hljs-annotation,.hljs-chunk,.hljs-comment{color:green}.bash .hljs-variable,.css .smalltalk .hljs-class,.hljs-built_in,.hljs-id,.hljs-keyword,.hljs-request,.hljs-status,.hljs-winutils,.nginx .hljs-title,.tex .hljs-command,.xml .hljs-tag,.xml .hljs-tag .hljs-value{color:#00f}.apache .hljs-tag,.coffeescript .hljs-attribute,.django .hljs-variable,.hljs-addition,.hljs-date,.hljs-flow,.hljs-parent,.hljs-rules .hljs-value,.hljs-stream,.hljs-string,.hljs-tag .hljs-value,.hljs-template_tag,.hljs-title,.ruby .hljs-symbol,.ruby .hljs-symbol .hljs-string,.tex .hljs-formula{color:#a31515}.apache .hljs-sqbracket,.hljs-array,.hljs-attr_selector,.hljs-decorator,.hljs-deletion,.hljs-doctype,.hljs-envvar,.hljs-filter .hljs-argument,.hljs-localvars,.hljs-pi,.hljs-pragma,.hljs-preprocessor,.hljs-prompt,.hljs-pseudo,.hljs-shebang,.nginx .hljs-built_in,.ruby .hljs-string,.tex .hljs-special,.userType{color:#2b91af}.hljs-dartdoc,.hljs-javadoc,.hljs-phpdoc,.hljs-xmlDocTag{color:gray}.hljs-type,.hljs-typename{font-weight:700}.vhdl .hljs-string{color:#666}.vhdl .hljs-literal{color:#a31515}.vhdl .hljs-attribute{color:#00b0e8}.xml .hljs-attribute{color:red}.MathJax_Hover_Frame{border-radius:.25em;-webkit-border-radius:.25em;-moz-border-radius:.25em;-khtml-border-radius:.25em;box-shadow:0 0 15px #83A;-webkit-box-shadow:0 0 15px #83A;-moz-box-shadow:0 0 15px #83A;-khtml-box-shadow:0 0 15px #83A;border:1px solid #A6D!important;display:inline-block;position:absolute}.MathJax_Hover_Arrow{position:absolute;width:15px;height:11px;cursor:pointer}#MathJax_About{position:fixed;left:50%;width:auto;text-align:center;border:3px outset;padding:1em 2em;background-color:#DDD;color:#000;cursor:default;font-family:message-box;font-size:120%;font-style:normal;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:15px;-webkit-border-radius:15px;-moz-border-radius:15px;-khtml-border-radius:15px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_Menu{position:absolute;background-color:#fff;color:#000;width:auto;padding:2px;border:1px solid #CCC;margin:0;cursor:default;font:menu;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_MenuItem{padding:2px 2em;background:0 0}.MathJax_MenuArrow{position:absolute;right:.5em;color:#666}.MathJax_MenuActive .MathJax_MenuArrow{color:#fff}.MathJax_MenuArrow.RTL{left:.5em;right:auto}.MathJax_MenuCheck{position:absolute;left:.7em}.MathJax_MenuCheck.RTL{right:.7em;left:auto}.MathJax_MenuRadioCheck{position:absolute;left:1em}.MathJax_MenuRadioCheck.RTL{right:1em;left:auto}.MathJax_MenuLabel{padding:2px 2em 4px 1.33em;font-style:italic}.MathJax_MenuRule{border-top:1px solid #CCC;margin:4px 1px 0}.MathJax_MenuDisabled{color:GrayText}.MathJax_MenuActive{background-color:Highlight;color:HighlightText}.MathJax_Menu_Close{position:absolute;width:31px;height:31px;top:-15px;left:-15px}#MathJax_Zoom{position:absolute;background-color:#F0F0F0;overflow:auto;display:block;z-index:301;padding:.5em;border:1px solid #000;margin:0;font-weight:400;font-style:normal;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;box-shadow:5px 5px 15px #AAA;-webkit-box-shadow:5px 5px 15px #AAA;-moz-box-shadow:5px 5px 15px #AAA;-khtml-box-shadow:5px 5px 15px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}#MathJax_ZoomOverlay{position:absolute;left:0;top:0;z-index:300;display:inline-block;width:100%;height:100%;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_ZoomFrame{position:relative;display:inline-block;height:0;width:0}#MathJax_ZoomEventTrap{position:absolute;left:0;top:0;z-index:302;display:inline-block;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}.MathJax_Preview{color:#888}#MathJax_Message{position:fixed;left:1px;bottom:2px;background-color:#E6E6E6;border:1px solid #959595;margin:0;padding:2px 8px;z-index:102;color:#000;font-size:80%;width:auto;white-space:nowrap}#MathJax_MSIE_Frame{position:absolute;top:0;left:0;width:0;z-index:101;border:0;margin:0;padding:0}.MathJax_Error{color:#C00;font-style:italic}.MathJax_Display{text-align:center;margin:1em 0;position:relative;display:block!important;text-indent:0;max-width:none;max-height:none;min-width:0;min-height:0;width:100%}.MathJax .merror{background-color:#FF8;color:#C00;border:1px solid #C00;padding:1px 3px;font-style:normal;font-size:90%}.MathJax .MJX-monospace{font-family:monospace}.MathJax .MJX-sans-serif{font-family:sans-serif}#MathJax_Tooltip{background-color:InfoBackground;color:InfoText;border:1px solid #000;box-shadow:2px 2px 5px #AAA;-webkit-box-shadow:2px 2px 5px #AAA;-moz-box-shadow:2px 2px 5px #AAA;-khtml-box-shadow:2px 2px 5px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true');padding:3px 4px;z-index:401;position:absolute;left:0;top:0;width:auto;height:auto;display:none}.MathJax{display:inline;font-style:normal;font-weight:400;line-height:normal;font-size:100%;font-size-adjust:none;text-indent:0;text-align:left;text-transform:none;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;direction:ltr;max-width:none;max-height:none;min-width:0;min-height:0;border:0;padding:0;margin:0}.MathJax a,.MathJax img,.MathJax nobr{border:0;padding:0;margin:0;max-width:5000em;max-height:5000em;min-width:0;min-height:0;vertical-align:0;line-height:normal;text-decoration:none}img.MathJax_strut{border:0!important;padding:0!important;margin:0!important;vertical-align:0!important}.MathJax span{display:inline;position:static;border:0;padding:0;margin:0;vertical-align:0;line-height:normal;text-decoration:none}.MathJax nobr{white-space:nowrap!important}.MathJax img{display:inline!important;float:none!important}.MathJax *{transition:none;-webkit-transition:none;-moz-transition:none;-ms-transition:none;-o-transition:none}.MathJax_Processing{visibility:hidden;position:fixed;width:0;height:0;overflow:hidden}.MathJax_Processed{display:none!important}.MathJax_ExBox{display:block!important;overflow:hidden;width:1px;height:60ex;min-height:0;max-height:none}.MathJax .MathJax_EmBox{display:block!important;overflow:hidden;width:1px;height:60em;min-height:0;max-height:none}.MathJax .MathJax_HitBox{cursor:text;background:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_Tooltip *,.MathJax .MathJax_HitBox *{filter:none;opacity:1;background:0 0}@font-face{font-family:MathJax_Main;src:url(file:///C:/Users/fpassold/AppData/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/Users/fpassold/AppData/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Main;src:url(file:///C:/Users/fpassold/AppData/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/Users/fpassold/AppData/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.4-beta-2) format('opentype');font-weight:700}@font-face{font-family:MathJax_Main;src:url(file:///C:/Users/fpassold/AppData/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/Users/fpassold/AppData/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.4-beta-2) format('opentype');font-style:italic}@font-face{font-family:MathJax_Math;src:url(file:///C:/Users/fpassold/AppData/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/Users/fpassold/AppData/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.4-beta-2) format('opentype');font-style:italic}@font-face{font-family:MathJax_Caligraphic;src:url(file:///C:/Users/fpassold/AppData/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/Users/fpassold/AppData/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size1;src:url(file:///C:/Users/fpassold/AppData/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/Users/fpassold/AppData/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size2;src:url(file:///C:/Users/fpassold/AppData/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/Users/fpassold/AppData/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size3;src:url(file:///C:/Users/fpassold/AppData/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/Users/fpassold/AppData/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size4;src:url(file:///C:/Users/fpassold/AppData/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/Users/fpassold/AppData/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.4-beta-2) format('opentype')}.MathJax .noError{font-size:90%;text-align:left;color:#000;padding:1px 3px;border:1px solid}footer{position:fixed;font-size:.8em;text-align:right;bottom:0;margin-left:-25px;height:20px;width:100%}</style>
</head>
<body class="markdown clearness">
<p><img src="https://images.unsplash.com/photo-1553451166-232112bda6f6?ixlib=rb-4.0.3&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=872&amp;q=80" alt="https://images.unsplash.com/photo-1553451166-232112bda6f6?ixlib=rb-4.0.3&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=872&amp;q=80"><br></p><font size="1">Photo by <a href="https://unsplash.com/@gaellemarcel?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Gaelle Marcel</a> on <a href="https://unsplash.com/collections/12245096/work-hard?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></font><h1 id="projeto-final"><a name="projeto-final" href="#projeto-final"></a>Projeto Final</h1><h2 id="atvidade:-gerador-de-onda-senoidal-40-hz"><a name="atvidade:-gerador-de-onda-senoidal-40-hz" href="#atvidade:-gerador-de-onda-senoidal-40-hz"></a>Atvidade: Gerador de Onda Senoidal 40 Hz</h2><p>Data: 10/11/2022, 14/11/2022, 15/11/2022, 16/11/2022.</p><p><strong>Ideia</strong>: gerar uma onda senoidal de 40 Hz, usando saída PWM filtrada do Arduino.</p><p><strong>Detalhes</strong>: placas Arduíno não possuem conversores D/A, então a ideia é filtrar alguma saída PWM do Arduíno.</p><h2 id="gerador-pwm-no-arduíno"><a name="gerador-pwm-no-arduíno" href="#gerador-pwm-no-arduíno"></a>Gerador PWM no Arduíno</h2><p>A ideia aqui é gerar um nível DC para atuar como sinal atuador de controle para o kit da Feedback. Temos que disponibilizar uma tensão DC variando entre 0 até 5 Volts numa das entradas do módulo Servo Amplificador (SA150D). Eventualmente (para atuar como um seguidor de tensão), podemos usar o módulo pré-amplificador (PA150C) para a partir deste, injetar o sinal de controle no módulo Servo Amplificador. Algo semelhante ao ilustrado na próxima figura:</p><p><img src="figuras/conexao_saida_PWM_filtrada_kit_feedback.png" alt="conexao_saida_PWM_filtrada_kit_feedback.png"></p><p>Supondo que vamos gerar a onda senoidal na faixa dos 40 Hz, uma boa frequência de corte para o filtro passa-baixas aqui seria a partir dos 400 Hz.</p><p>É bom lembrar que o sinal PWM gerado por “default” pelo Arduíno, parece:</p><ul>
<li>pinos 5 e 6, vibrando na frequencia de 980 Hz, compartilhando o <strong>Timer0</strong> com as funções <code>delay()</code> e <code>millis()</code> — ver <a href="https://www.best-microcontroller-projects.com/arduino-analog-output.html">“Arduino Analog Output:Impossible Analog; using Digital Pins. How to generate an Analog Output varying from 0V to 5V using only Digital pins!”</a> (acessado em 03/11/2022)</li><li>pinos 3, 9, 10 e 11, vibrando na frequência de 490 Hz, usando, dependendo do pino, o <strong>Timmer1</strong> ou o <strong>Timmer2</strong>.</li></ul><p>A tabela a seguir detalha melhor que temporizadores do Arduíno trabalham com que pino para gerar sinal PWM:</p><table>
<thead>
<tr>
<th style="text-align:center">Pinos Arduíno (PWM)</th>
<th style="text-align:center">Timmer</th>
<th style="text-align:center">Registrador</th>
<th style="text-align:center">Frequência</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">Timer2</td>
<td style="text-align:center">OC2B</td>
<td style="text-align:center">490 Hz</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">Timer0</td>
<td style="text-align:center">OC0B</td>
<td style="text-align:center"><strong>980 Hz</strong></td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">Timer0</td>
<td style="text-align:center">OC0A</td>
<td style="text-align:center"><strong>980 Hz</strong></td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">Timer1</td>
<td style="text-align:center">OC1A</td>
<td style="text-align:center">490 Hz</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">Timer1</td>
<td style="text-align:center">OC1B</td>
<td style="text-align:center">490 Hz</td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:center">Timer2</td>
<td style="text-align:center">OC2A</td>
<td style="text-align:center">490 Hz</td>
</tr>
</tbody>
</table><p>Note que:</p><ul>
<li>Timer0: usado pelos pinos 5 e 6;</li><li>Timer1: usado pelos pinos 9 e 10;</li><li>Timer2: usado pelos pinos 3 e 11.</li></ul><p>É melhor sempre optar pela frequência mais elevada possível para o gerador PWM. Neste caso, seria 980 HZ, encontrada apenas nos pino 5 e 6 do Arduíno. Neste caso, vamos optar por <strong>usar o pino 5</strong>.</p><p><strong>Cuidados</strong>: o próprio <a href="https://www.arduino.cc/reference/en/language/functions/analog-io/analogwrite/">site do Arduino</a> alerta para o fato de que os pinos 5 e 6 usam o Timer0 (frequencia mais alta) mas como este timer também é compartilhado com as funções <code>millis()</code> e <code>delay()</code>, o usuário DEVE esperar valores mais elevados que o solicitado se insistir em usar estas últimas funções. Este problema é mais comum acontecer para baixos valores de duty-cycle. Esperamos que isto não ocorra no nosso caso.</p><h3 id="filtro-rc-na-saída-pwm"><a name="filtro-rc-na-saída-pwm" href="#filtro-rc-na-saída-pwm"></a>Filtro RC na saída PWM</h3><p>Considerando que vamos trabalhar com o <strong>pino 5 (<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1" style="width: 6.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.387em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.855em 1000em 3.136em -0.425em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 2.575em; height: 0px;"><span style="position: absolute; clip: rect(1.695em 1000em 2.925em -0.425em); top: -2.56em; left: 0em;"><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span><span style="position: absolute; top: -2.213em; left: 0.527em;"><span class="texatom" id="MathJax-Span-5"><span class="mrow" id="MathJax-Span-6"><span class="mi" id="MathJax-Span-7" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mi" id="MathJax-Span-8" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.074em;"></span></span><span class="mi" id="MathJax-Span-9" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-11" style="font-family: MathJax_Main; padding-left: 0.278em;">980</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.334em; vertical-align: -0.387em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">f_{PWM}=980</script></span>)</strong>, podemos filtrar este sinal via filtro passa-baixas (FPB) usando uma rede RC, estabelecendo a freq. de corte do filtro uma década abaixo, em <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-12" style="width: 4.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.253em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.855em 1000em 3.128em -0.425em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-13"><span class="msubsup" id="MathJax-Span-14"><span style="display: inline-block; position: relative; width: 0.922em; height: 0px;"><span style="position: absolute; clip: rect(1.695em 1000em 2.925em -0.425em); top: -2.56em; left: 0em;"><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span><span style="position: absolute; top: -2.213em; left: 0.527em;"><span class="mi" id="MathJax-Span-16" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span><span class="mo" id="MathJax-Span-17" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-18" style="font-family: MathJax_Main; padding-left: 0.278em;">98</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.325em; vertical-align: -0.377em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">f_c=98</script></span> Hz. Isto significa que componentes na faixa de 980 Hz serão reduzidos de 20 db, um “ganho”, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-19" style="width: 10.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.427em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.637em 1000em 3.074em -0.449em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-20"><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-22" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-23" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 3.435em; height: 0px;"><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.397em); top: -2.72em; left: 0em;"><span class="mn" id="MathJax-Span-24" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; top: -2.9em; left: 1.013em;"><span class="texatom" id="MathJax-Span-25"><span class="mrow" id="MathJax-Span-26"><span class="mo" id="MathJax-Span-27" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-28" style="font-size: 70.7%; font-family: MathJax_Main;">20</span><span class="texatom" id="MathJax-Span-29"><span class="mrow" id="MathJax-Span-30"><span class="mo" id="MathJax-Span-31" style="font-size: 70.7%; font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-32" style="font-size: 70.7%; font-family: MathJax_Main;">20</span></span></span><span style="display: inline-block; width: 0px; height: 2.507em;"></span></span></span></span><span class="mo" id="MathJax-Span-33" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-34" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-36" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.53em; vertical-align: -0.309em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">K=10^{-20/20}=0,1</script></span> em 980 Hz.</p><p>A frequência de corte do FPB é definida como:</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-4-Frame"><nobr><span class="math" id="MathJax-Span-37" style="width: 6.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.227em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.217em 1000em 3.588em -0.425em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-38"><span class="msubsup" id="MathJax-Span-39"><span style="display: inline-block; position: relative; width: 0.922em; height: 0px;"><span style="position: absolute; clip: rect(1.695em 1000em 2.925em -0.425em); top: -2.56em; left: 0em;"><span class="mi" id="MathJax-Span-40" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span><span style="position: absolute; top: -2.213em; left: 0.527em;"><span class="mi" id="MathJax-Span-41" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span><span class="mo" id="MathJax-Span-42" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mstyle" id="MathJax-Span-43" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-44"><span class="mfrac" id="MathJax-Span-45"><span style="display: inline-block; position: relative; width: 2.733em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.894em 1000em 2.88em -0.397em); top: -3.397em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-46" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; clip: rect(1.855em 1000em 2.902em -0.43em); top: -2.034em; left: 50%; margin-left: -1.307em;"><span class="mrow" id="MathJax-Span-47"><span class="mn" id="MathJax-Span-48" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-49" style="font-family: MathJax_Math; font-style: italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-50" style="font-family: MathJax_Math; font-style: italic;">R</span><span class="mi" id="MathJax-Span-51" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; clip: rect(0.84em 1000em 1.227em -0.48em); top: -1.287em; left: 0em;"><span style="border-left-width: 2.733em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.067em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.696em; vertical-align: -0.952em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-4">
f_c=\dfrac{1}{2\pi RC}</script><p></p><p>Usando R = 10 K<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-5-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-52" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.747em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.856em 1000em 2.88em -0.436em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-53"><span class="mi" id="MathJax-Span-54" style="font-family: MathJax_Main;">Ω</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">\Omega</script></span>, C deverá ser de:</p><pre class="matlab hljs"><code class="Matlab" data-origin="<pre><code class=&quot;Matlab&quot;>&amp;gt;&amp;gt; R=10E3;
&amp;gt;&amp;gt; fc=98;
&amp;gt;&amp;gt; C=1/(2*pi*R*fc)
C =
    1.624e-07
</code></pre>">&gt;&gt; R=<span class="hljs-number">10E3</span>;
&gt;&gt; fc=<span class="hljs-number">98</span>;
&gt;&gt; C=<span class="hljs-number">1</span>/(<span class="hljs-number">2</span>*<span class="hljs-built_in">pi</span>*R*fc)
C =
    <span class="hljs-number">1.624e-07</span>
</code></pre><p>Iso resulta num capacitor de <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-55" style="width: 5.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.213em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.696em 1000em 2.902em -0.397em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-56"><span class="mn" id="MathJax-Span-57" style="font-family: MathJax_Main;">164</span><span class="mo" id="MathJax-Span-58" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="msubsup" id="MathJax-Span-59" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.462em; height: 0px;"><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.397em); top: -2.72em; left: 0em;"><span class="mn" id="MathJax-Span-60" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; top: -2.9em; left: 1.013em;"><span class="texatom" id="MathJax-Span-61"><span class="mrow" id="MathJax-Span-62"><span class="mn" id="MathJax-Span-63" style="font-size: 70.7%; font-family: MathJax_Main;">9</span></span></span><span style="display: inline-block; width: 0px; height: 2.507em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.241em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">164 \times 10^{9}</script></span> F <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-64" style="width: 3.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.56em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.883em 1000em 2.902em -0.424em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-65"><span class="mo" id="MathJax-Span-66" style="font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-67" style="font-family: MathJax_Main; padding-left: 0.278em;">164</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.007em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">= 164</script></span> nF. Valores comerciais mais próximos estão em 150 nF e 220 nF. Recalculando as frequências de corte, teríamos:</p><pre class="matlab hljs"><code class="Matlab" data-origin="<pre><code class=&quot;Matlab&quot;>&amp;gt;&amp;gt; fc=1/(2*pi*10E3*C)
fc =
        106.1
&amp;gt;&amp;gt; C=220E-9;
&amp;gt;&amp;gt; fc=1/(2*pi*10E3*C)
fc =
       72.343
</code></pre>">&gt;&gt; fc=<span class="hljs-number">1</span>/(<span class="hljs-number">2</span>*<span class="hljs-built_in">pi</span>*<span class="hljs-number">10E3</span>*C)
fc =
        <span class="hljs-number">106.1</span>
&gt;&gt; C=<span class="hljs-number">220E-9</span>;
&gt;&gt; fc=<span class="hljs-number">1</span>/(<span class="hljs-number">2</span>*<span class="hljs-built_in">pi</span>*<span class="hljs-number">10E3</span>*C)
fc =
       <span class="hljs-number">72.343</span>
</code></pre><h2 id="gerando-a-onda-senoidal"><a name="gerando-a-onda-senoidal" href="#gerando-a-onda-senoidal"></a>Gerando a Onda Senoidal</h2><p>Supondo que queremos gerar uma senoide de 40 Hz, seria adequado amostrá-la ou gerar um sinal à 400 Hz, o que rende 10 pontos por ciclo da senoide e resulta em algo como:</p><pre class="matlab hljs"><code class="Matlab" data-origin="<pre><code class=&quot;Matlab&quot;>&amp;gt;&amp;gt; fsinal=40;
&amp;gt;&amp;gt; Tsinal=1/fsinal; 
&amp;gt;&amp;gt; fs=400;
&amp;gt;&amp;gt; Ts=1/fs; % freq de amostragem adotada
&amp;gt;&amp;gt; t=0:Ts:2*Tsinal; % gerando vetor tempo para 2 ciclos da senoide de 40 Hz
&amp;gt;&amp;gt; yd=sin(2*pi*fsinal*t);
&amp;gt;&amp;gt; t(length(t))  % valor final da var tempo findo os 2 períodos da senoide
ans =
         0.05 
&amp;gt;&amp;gt; figure;
&amp;gt;&amp;gt; ezplot('sin(2*pi*40*x)',[0 0.05])
&amp;gt;&amp;gt; hold on
&amp;gt;&amp;gt; plot(t,yd,'o-')
&amp;gt;&amp;gt; legend('senoide desejada', 'senoide sintetizada')
&amp;gt;&amp;gt; grid
</code></pre>">&gt;&gt; fsinal=<span class="hljs-number">40</span>;
&gt;&gt; Tsinal=<span class="hljs-number">1</span>/fsinal; 
&gt;&gt; fs=<span class="hljs-number">400</span>;
&gt;&gt; Ts=<span class="hljs-number">1</span>/fs; <span class="hljs-comment">% freq de amostragem adotada</span>
&gt;&gt; t=<span class="hljs-number">0</span>:Ts:<span class="hljs-number">2</span>*Tsinal; <span class="hljs-comment">% gerando vetor tempo para 2 ciclos da senoide de 40 Hz</span>
&gt;&gt; yd=<span class="hljs-built_in">sin</span>(<span class="hljs-number">2</span>*<span class="hljs-built_in">pi</span>*fsinal*t);
&gt;&gt; t(<span class="hljs-built_in">length</span>(t))  <span class="hljs-comment">% valor final da var tempo findo os 2 períodos da senoide</span>
<span class="hljs-built_in">ans</span> =
         <span class="hljs-number">0.05</span> 
&gt;&gt; figure;
&gt;&gt; ezplot(<span class="hljs-string">'sin(2*pi*40*x)'</span>,<span class="hljs-matrix">[<span class="hljs-number">0</span> <span class="hljs-number">0.05</span>]</span>)
&gt;&gt; hold on
&gt;&gt; plot(t,yd,<span class="hljs-string">'o-'</span>)
&gt;&gt; legend(<span class="hljs-string">'senoide desejada'</span>, <span class="hljs-string">'senoide sintetizada'</span>)
&gt;&gt; grid
</code></pre><p>Gráfico da senoide de 40 Hz amostrada à 400 Hz:</p><p><img src="figuras/senoide_40_fs_400_red.png" alt="senoide_40_fs_400.png"></p><p>Detalhe: no momento de codificar no Arduíno, esta onda senoidal deverá oscilar entre os valores 0 à 255 (tipo de dado <code>int</code>). Então, modificamos a rotina no Matlab para gerar a senóide nesta faixa de valores:</p><pre class="matlab hljs"><code class="Matlab" data-origin="<pre><code class=&quot;Matlab&quot;>&amp;gt;&amp;gt; fsinal=40;
&amp;gt;&amp;gt; Tsinal=1/fsinal; 
&amp;gt;&amp;gt; fs=400;
&amp;gt;&amp;gt; Ts=1/fs % freq de amostragem adotada

&amp;gt;&amp;gt; t=0:Ts:2*Tsinal; % gerando vetor tempo para 2 ciclos da senoide de 40 Hz
&amp;gt;&amp;gt; 256/2
ans =
   128
&amp;gt;&amp;gt; yd=128+128*sin(2*pi*fsinal*t);
&amp;gt;&amp;gt; t(length(t))  % valor final da var tempo findo os 2 períodos da senoide
ans =
         0.05 
&amp;gt;&amp;gt; figure;
&amp;gt;&amp;gt; ezplot('128+128*sin(2*pi*40*x)',[0 0.05])
&amp;gt;&amp;gt; hold on
&amp;gt;&amp;gt; plot(t,yd,'o-')
&amp;gt;&amp;gt; legend('senoide desejada', 'senoide sintetizada')
&amp;gt;&amp;gt; grid
</code></pre>">&gt;&gt; fsinal=<span class="hljs-number">40</span>;
&gt;&gt; Tsinal=<span class="hljs-number">1</span>/fsinal; 
&gt;&gt; fs=<span class="hljs-number">400</span>;
&gt;&gt; Ts=<span class="hljs-number">1</span>/fs <span class="hljs-comment">% freq de amostragem adotada</span>

&gt;&gt; t=<span class="hljs-number">0</span>:Ts:<span class="hljs-number">2</span>*Tsinal; <span class="hljs-comment">% gerando vetor tempo para 2 ciclos da senoide de 40 Hz</span>
&gt;&gt; <span class="hljs-number">256</span>/<span class="hljs-number">2</span>
<span class="hljs-built_in">ans</span> =
   <span class="hljs-number">128</span>
&gt;&gt; yd=<span class="hljs-number">128</span>+<span class="hljs-number">128</span>*<span class="hljs-built_in">sin</span>(<span class="hljs-number">2</span>*<span class="hljs-built_in">pi</span>*fsinal*t);
&gt;&gt; t(<span class="hljs-built_in">length</span>(t))  <span class="hljs-comment">% valor final da var tempo findo os 2 períodos da senoide</span>
<span class="hljs-built_in">ans</span> =
         <span class="hljs-number">0.05</span> 
&gt;&gt; figure;
&gt;&gt; ezplot(<span class="hljs-string">'128+128*sin(2*pi*40*x)'</span>,<span class="hljs-matrix">[<span class="hljs-number">0</span> <span class="hljs-number">0.05</span>]</span>)
&gt;&gt; hold on
&gt;&gt; plot(t,yd,<span class="hljs-string">'o-'</span>)
&gt;&gt; legend(<span class="hljs-string">'senoide desejada'</span>, <span class="hljs-string">'senoide sintetizada'</span>)
&gt;&gt; grid
</code></pre><p><img src="figuras/senoide_40_gain_offset_128_red.png" alt="senoide_40_gain_offset_128.png"></p><p>Então a equação final da senoide a ser implementada no Arduíno na rotina ISR é:</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-8-Frame"><nobr><span class="math" id="MathJax-Span-68" style="width: 19.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.413em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.81em 1000em 3.13em -0.459em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-69"><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-71" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-72" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-73" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-75" style="font-family: MathJax_Main; padding-left: 0.278em;">128</span><span class="mo" id="MathJax-Span-76" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-77" style="font-family: MathJax_Main; padding-left: 0.222em;">128</span><span class="mi" id="MathJax-Span-78" style="font-family: MathJax_Main; padding-left: 0.167em;">sin</span><span class="mo" id="MathJax-Span-79"></span><span class="mo" id="MathJax-Span-80" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-81" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math; font-style: italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mspace" id="MathJax-Span-83" style="height: 0em; vertical-align: 0em; width: 0.167em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-84" style="font-family: MathJax_Main;">40</span><span class="mspace" id="MathJax-Span-85" style="height: 0em; vertical-align: 0em; width: 0.167em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-86" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-87" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-88" style="height: 0em; vertical-align: 0em; width: 2em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-89" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-90" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-91" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.383em; vertical-align: -0.379em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-8">
y(t)=128+128\sin(2\pi\,40\,t) \qquad (1)</script><p></p><p>Note mais especificamente, que os primeiros 10 valores são repetidos de forma periódica e são:</p><pre class="matlab hljs"><code class="Matlab" data-origin="<pre><code class=&quot;Matlab&quot;>&amp;gt;&amp;gt; [t(1:12)' yd(1:12)']
ans =
            0          128
       0.0025       203.24
        0.005       249.74
       0.0075       249.74
         0.01       203.24
       0.0125          128
        0.015       52.763
       0.0175       6.2648
         0.02       6.2648
       0.0225       52.763
        0.025          128
       0.0275       203.24
</code></pre>">&gt;&gt; <span class="hljs-matrix">[t(<span class="hljs-number">1</span>:<span class="hljs-number">12</span>)<span class="hljs-string">' yd(1:12)'</span>]</span>
<span class="hljs-built_in">ans</span> =
            <span class="hljs-number">0</span>          <span class="hljs-number">128</span>
       <span class="hljs-number">0.0025</span>       <span class="hljs-number">203.24</span>
        <span class="hljs-number">0.005</span>       <span class="hljs-number">249.74</span>
       <span class="hljs-number">0.0075</span>       <span class="hljs-number">249.74</span>
         <span class="hljs-number">0.01</span>       <span class="hljs-number">203.24</span>
       <span class="hljs-number">0.0125</span>          <span class="hljs-number">128</span>
        <span class="hljs-number">0.015</span>       <span class="hljs-number">52.763</span>
       <span class="hljs-number">0.0175</span>       <span class="hljs-number">6.2648</span>
         <span class="hljs-number">0.02</span>       <span class="hljs-number">6.2648</span>
       <span class="hljs-number">0.0225</span>       <span class="hljs-number">52.763</span>
        <span class="hljs-number">0.025</span>          <span class="hljs-number">128</span>
       <span class="hljs-number">0.0275</span>       <span class="hljs-number">203.24</span>
</code></pre><p>Outro detalhe: não podemos, dentro da rotina ISR para executar a eq. (1), usar alguma variável <code>t</code> porque fatalmente atingiríamos o limite (scopo) desta variável. A opção seria usar uma variável do tipo <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-9-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-92" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.853em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.683em 1000em 2.731em -0.444em); top: -2.56em; left: 0em;"><span class="mrow" id="MathJax-Span-93"><span class="mi" id="MathJax-Span-94" style="font-family: MathJax_Math; font-style: italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math; font-style: italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.043em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">\delta t</script></span>, para definir o “passo”  ou incremento que teria que ser dado na variável <code>t</code> e da mesma forma, o limite da variável seria atingido. Uma opçao mais fácil e certeira nesta caso é, ao invés de passar como argumento de entrada, a variável <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-10-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-96" style="width: 0.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.373em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.774em 1000em 2.731em -0.461em); top: -2.56em; left: 0em;"><span class="mrow" id="MathJax-Span-97"><span class="mi" id="MathJax-Span-98" style="font-family: MathJax_Math; font-style: italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.93em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">t</script></span>, passarmos o ângulo para a senóide neste ponto. Isto é, a senoide se repete a cada intervalo <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-11-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-99" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.747em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.723em 1000em 2.72em -0.459em); top: -2.56em; left: 0em;"><span class="mrow" id="MathJax-Span-100"><span class="mi" id="MathJax-Span-101" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.98em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">T</script></span> que neste caso, corresponderia aos <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-12-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-102" style="width: 2.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.027em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.482em 1000em 2.529em -0.438em); top: -2.347em; left: 0em;"><span class="mrow" id="MathJax-Span-103"><span class="msubsup" id="MathJax-Span-104"><span style="display: inline-block; position: relative; width: 1.995em; height: 0px;"><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.438em); top: -2.72em; left: 0em;"><span class="mn" id="MathJax-Span-105" style="font-family: MathJax_Main;">360</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; top: -2.846em; left: 1.547em;"><span class="mi" id="MathJax-Span-106" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.347em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.042em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">360^o</script></span> (<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-13-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-107" style="width: 1.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.894em 1000em 2.891em -0.43em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-108"><span class="mn" id="MathJax-Span-109" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-110" style="font-family: MathJax_Math; font-style: italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.98em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">2\pi</script></span>). Como esta senoide será gerada usando 10 pontos da mesma, basta dividir por igual o intervalo de <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-14-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-111" style="width: 2.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.027em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.482em 1000em 2.529em -0.438em); top: -2.347em; left: 0em;"><span class="mrow" id="MathJax-Span-112"><span class="msubsup" id="MathJax-Span-113"><span style="display: inline-block; position: relative; width: 1.995em; height: 0px;"><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.438em); top: -2.72em; left: 0em;"><span class="mn" id="MathJax-Span-114" style="font-family: MathJax_Main;">360</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; top: -2.846em; left: 1.547em;"><span class="mi" id="MathJax-Span-115" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.347em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.042em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">360^o</script></span> em 10 pontos, ou seja, un novo ponto da senoíde é gerado a cada <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-15-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-116" style="width: 15.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.267em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.217em 1000em 3.588em -0.434em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-117"><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mstyle" id="MathJax-Span-121" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-122"><span class="mfrac" id="MathJax-Span-123"><span style="display: inline-block; position: relative; width: 2.84em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.894em 1000em 2.88em -0.397em); top: -3.397em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-124" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; clip: rect(1.883em 1000em 2.902em -0.397em); top: -2.034em; left: 50%; margin-left: -1.36em;"><span class="mrow" id="MathJax-Span-125"><span class="mn" id="MathJax-Span-126" style="font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-127" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="mn" id="MathJax-Span-128" style="font-family: MathJax_Main; padding-left: 0.222em;">40</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; clip: rect(0.84em 1000em 1.227em -0.48em); top: -1.287em; left: 0em;"><span style="border-left-width: 2.84em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.067em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-130" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span style="position: absolute; clip: rect(1.723em 1000em 2.72em -0.459em); top: -2.56em; left: 0em;"><span class="mi" id="MathJax-Span-131" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span><span style="position: absolute; top: -2.303em; left: 0.627em;"><span class="mi" id="MathJax-Span-132" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-134" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-136" style="font-family: MathJax_Main; padding-left: 0.167em;">0025</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.696em; vertical-align: -0.952em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">\Delta t = \dfrac{1}{10 \cdot 40} = T_s = 0,0025</script></span> segundos <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-16-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-137" style="width: 3.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.507em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.894em 1000em 3.074em -0.424em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-138"><span class="mo" id="MathJax-Span-139" style="font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-140" style="font-family: MathJax_Main; padding-left: 0.278em;">2</span><span class="mo" id="MathJax-Span-141" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-142" style="font-family: MathJax_Main; padding-left: 0.167em;">5</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.208em; vertical-align: -0.309em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">=2,5</script></span> ms, que equivale à <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-17-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-143" style="width: 9.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.787em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.179em 1000em 3.588em -0.434em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-144"><span class="mi" id="MathJax-Span-145" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mstyle" id="MathJax-Span-148" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-149"><span class="mfrac" id="MathJax-Span-150"><span style="display: inline-block; position: relative; width: 2.115em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.135em 1000em 4.182em -0.438em); top: -4.677em; left: 50%; margin-left: -0.998em;"><span class="msubsup" id="MathJax-Span-151"><span style="display: inline-block; position: relative; width: 1.995em; height: 0px;"><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.438em); top: -2.72em; left: 0em;"><span class="mn" id="MathJax-Span-152" style="font-family: MathJax_Main;">360</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; top: -2.846em; left: 1.547em;"><span class="mi" id="MathJax-Span-153" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4em;"></span></span><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.397em); top: -2.034em; left: 50%; margin-left: -0.507em;"><span class="mn" id="MathJax-Span-154" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; clip: rect(0.84em 1000em 1.227em -0.48em); top: -1.287em; left: 0em;"><span style="border-left-width: 2.115em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.067em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-155" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-156" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.462em; height: 0px;"><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.438em); top: -2.72em; left: 0em;"><span class="mn" id="MathJax-Span-157" style="font-family: MathJax_Main;">36</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; top: -2.846em; left: 1.013em;"><span class="mi" id="MathJax-Span-158" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.745em; vertical-align: -0.952em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">\Delta \theta = \dfrac{360^o}{10}=36^o</script></span> ou <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-18-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-159" style="width: 10.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.693em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.217em 1000em 3.588em -0.434em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-160"><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-162" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-163" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mstyle" id="MathJax-Span-164" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-165"><span class="mfrac" id="MathJax-Span-166"><span style="display: inline-block; position: relative; width: 1.24em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.894em 1000em 2.891em -0.43em); top: -3.397em; left: 50%; margin-left: -0.56em;"><span class="mrow" id="MathJax-Span-167"><span class="mn" id="MathJax-Span-168" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-169" style="font-family: MathJax_Math; font-style: italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.397em); top: -2.034em; left: 50%; margin-left: -0.507em;"><span class="mn" id="MathJax-Span-170" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; clip: rect(0.84em 1000em 1.227em -0.48em); top: -1.287em; left: 0em;"><span style="border-left-width: 1.24em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.067em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-171" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-172" style="font-family: MathJax_Main; padding-left: 0.278em;">0.62832</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.696em; vertical-align: -0.952em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">\Delta \theta = \dfrac{2\pi}{10} = 0.62832</script></span> rad.</p><pre class="matlab hljs"><code class="Matlab" data-origin="<pre><code class=&quot;Matlab&quot;>&amp;gt;&amp;gt; delta_theta=2*pi/10 % ciclo completo da senoide dividido em 10 pontos
delta_theta =
      0.62832
&amp;gt;&amp;gt; theta=0:delta_theta:2*pi;
&amp;gt;&amp;gt; theta'
ans =
            0
      0.62832
       1.2566
        1.885
       2.5133
       3.1416
       3.7699
       4.3982
       5.0265
       5.6549
       6.2832
&amp;gt;&amp;gt; 2*pi
ans =
       6.2832
&amp;gt;&amp;gt;
</code></pre>">&gt;&gt; delta_theta=<span class="hljs-number">2</span>*<span class="hljs-built_in">pi</span>/<span class="hljs-number">10</span> <span class="hljs-comment">% ciclo completo da senoide dividido em 10 pontos</span>
delta_theta =
      <span class="hljs-number">0.62832</span>
&gt;&gt; theta=<span class="hljs-number">0</span>:delta_theta:<span class="hljs-number">2</span>*<span class="hljs-built_in">pi</span>;
&gt;&gt; theta<span class="hljs-operator">'</span>
<span class="hljs-built_in">ans</span> =
            <span class="hljs-number">0</span>
      <span class="hljs-number">0.62832</span>
       <span class="hljs-number">1.2566</span>
        <span class="hljs-number">1.885</span>
       <span class="hljs-number">2.5133</span>
       <span class="hljs-number">3.1416</span>
       <span class="hljs-number">3.7699</span>
       <span class="hljs-number">4.3982</span>
       <span class="hljs-number">5.0265</span>
       <span class="hljs-number">5.6549</span>
       <span class="hljs-number">6.2832</span>
&gt;&gt; <span class="hljs-number">2</span>*<span class="hljs-built_in">pi</span>
<span class="hljs-built_in">ans</span> =
       <span class="hljs-number">6.2832</span>
&gt;&gt;
</code></pre><p>Note que o último valor de vetor acima, repete o primeira amostra (posição zero do vetor <code>theta</code>).</p><p>Podemos aproveitar e gerar um vetor no Matlab (que pode ser incorporado no código do Arduíno) com os 10 valores que devem ser gerados (o ciclo completo da senoide) a cada intervalo de tempo ou intervalo angular. Aproveitando os cálculos já gerados anteriormente (que estão no workspace do Matlab), seria algo como:</p><pre class="matlab hljs"><code class="Matlab" data-origin="<pre><code class=&quot;Matlab&quot;>&amp;gt;&amp;gt; index=0:10;
&amp;gt;&amp;gt; escala=100/256
escala =
      0.39063
&amp;gt;&amp;gt; yd_per=yd*escala; % valor duty-cycle de saída em %
&amp;gt;&amp;gt; [index(1:11)' t(1:11)' theta(1:11)' yd(1:11)' yd_per(1:11)']
ans =
            0            0            0          128           50
            1       0.0025      0.62832       203.24       79.389
            2        0.005       1.2566       249.74       97.553
            3       0.0075        1.885       249.74       97.553
            4         0.01       2.5133       203.24       79.389
            5       0.0125       3.1416          128           50
            6        0.015       3.7699       52.763       20.611
            7       0.0175       4.3982       6.2648       2.4472
            8         0.02       5.0265       6.2648       2.4472
            9       0.0225       5.6549       52.763       20.611
           10        0.025       6.2832          128           50
&amp;gt;&amp;gt;
</code></pre>">&gt;&gt; index=<span class="hljs-number">0</span>:<span class="hljs-number">10</span>;
&gt;&gt; escala=<span class="hljs-number">100</span>/<span class="hljs-number">256</span>
escala =
      <span class="hljs-number">0.39063</span>
&gt;&gt; yd_per=yd*escala; <span class="hljs-comment">% valor duty-cycle de saída em %</span>
&gt;&gt; <span class="hljs-matrix">[index(<span class="hljs-number">1</span>:<span class="hljs-number">11</span>)<span class="hljs-string">' t(1:11)'</span> theta(<span class="hljs-number">1</span>:<span class="hljs-number">11</span>)<span class="hljs-string">' yd(1:11)'</span> yd_per(<span class="hljs-number">1</span>:<span class="hljs-number">11</span>)<span class="hljs-string">']
ans =
            0            0            0          128           50
            1       0.0025      0.62832       203.24       79.389
            2        0.005       1.2566       249.74       97.553
            3       0.0075        1.885       249.74       97.553
            4         0.01       2.5133       203.24       79.389
            5       0.0125       3.1416          128           50
            6        0.015       3.7699       52.763       20.611
            7       0.0175       4.3982       6.2648       2.4472
            8         0.02       5.0265       6.2648       2.4472
            9       0.0225       5.6549       52.763       20.611
           10        0.025       6.2832          128           50
&gt;&gt;
</span></span></code></pre><p>Algumas considerações:</p><ol>
<li>Estamos amostrando a senoide à 400 Hz, resultando em 10 pontos por ciclo;</li><li>A “distância” (período de tempo) entre cada ponto amostrado é de: <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-19-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-173" style="width: 11.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.173em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.81em 1000em 3.13em -0.459em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-174"><span class="msubsup" id="MathJax-Span-175"><span style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span style="position: absolute; clip: rect(1.723em 1000em 2.72em -0.459em); top: -2.56em; left: 0em;"><span class="mi" id="MathJax-Span-176" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span><span style="position: absolute; top: -2.303em; left: 0.627em;"><span class="mi" id="MathJax-Span-177" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-179" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-180"><span class="mrow" id="MathJax-Span-181"><span class="mo" id="MathJax-Span-182" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-183" style="font-family: MathJax_Main;">400</span><span class="mo" id="MathJax-Span-184" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-185" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span><span class="mo" id="MathJax-Span-186" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-187" style="font-family: MathJax_Main; padding-left: 0.167em;">0025</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.383em; vertical-align: -0.379em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">T_s=1/400=0,0025</script></span> ou 2,5 ms;</li><li>No intervalo de tempo acima, a saída PWM do Arduíno em <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-20-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-188" style="width: 6.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.387em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.855em 1000em 3.136em -0.425em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-189"><span class="msubsup" id="MathJax-Span-190"><span style="display: inline-block; position: relative; width: 2.575em; height: 0px;"><span style="position: absolute; clip: rect(1.695em 1000em 2.925em -0.425em); top: -2.56em; left: 0em;"><span class="mi" id="MathJax-Span-191" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span><span style="position: absolute; top: -2.213em; left: 0.527em;"><span class="texatom" id="MathJax-Span-192"><span class="mrow" id="MathJax-Span-193"><span class="mi" id="MathJax-Span-194" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mi" id="MathJax-Span-195" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.074em;"></span></span><span class="mi" id="MathJax-Span-196" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span><span class="mo" id="MathJax-Span-197" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-198" style="font-family: MathJax_Main; padding-left: 0.278em;">980</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.334em; vertical-align: -0.387em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">f_{PWM}=980</script></span> Hz (<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-199" style="width: 15.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.267em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.81em 1000em 3.13em -0.459em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-200"><span class="msubsup" id="MathJax-Span-201"><span style="display: inline-block; position: relative; width: 2.675em; height: 0px;"><span style="position: absolute; clip: rect(1.723em 1000em 2.72em -0.459em); top: -2.56em; left: 0em;"><span class="mi" id="MathJax-Span-202" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span><span style="position: absolute; top: -2.303em; left: 0.627em;"><span class="texatom" id="MathJax-Span-203"><span class="mrow" id="MathJax-Span-204"><span class="mi" id="MathJax-Span-205" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mi" id="MathJax-Span-206" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.074em;"></span></span><span class="mi" id="MathJax-Span-207" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span><span class="mo" id="MathJax-Span-208" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-209" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-210"><span class="mrow" id="MathJax-Span-211"><span class="mo" id="MathJax-Span-212" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-213" style="font-family: MathJax_Main;">980</span><span class="mo" id="MathJax-Span-214" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-215" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span><span class="mo" id="MathJax-Span-216" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-217" style="font-family: MathJax_Main; padding-left: 0.167em;">0010204</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.383em; vertical-align: -0.379em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">T_{PWM}=1/980=0,0010204</script></span> ou 1,0204 ms), consegue sintetizar: 2,45 ciclos do sinal PWM (<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-218" style="width: 9.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.36em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.81em 1000em 3.13em -0.459em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-219"><span class="msubsup" id="MathJax-Span-220"><span style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span style="position: absolute; clip: rect(1.723em 1000em 2.72em -0.459em); top: -2.56em; left: 0em;"><span class="mi" id="MathJax-Span-221" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span><span style="position: absolute; top: -2.303em; left: 0.627em;"><span class="mi" id="MathJax-Span-222" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span><span class="texatom" id="MathJax-Span-223"><span class="mrow" id="MathJax-Span-224"><span class="mo" id="MathJax-Span-225" style="font-family: MathJax_Main;">/</span></span></span><span class="msubsup" id="MathJax-Span-226"><span style="display: inline-block; position: relative; width: 2.675em; height: 0px;"><span style="position: absolute; clip: rect(1.723em 1000em 2.72em -0.459em); top: -2.56em; left: 0em;"><span class="mi" id="MathJax-Span-227" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span><span style="position: absolute; top: -2.303em; left: 0.627em;"><span class="texatom" id="MathJax-Span-228"><span class="mrow" id="MathJax-Span-229"><span class="mi" id="MathJax-Span-230" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mi" id="MathJax-Span-231" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.074em;"></span></span><span class="mi" id="MathJax-Span-232" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span><span class="mo" id="MathJax-Span-233" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-234" style="font-family: MathJax_Main; padding-left: 0.278em;">2.45</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.383em; vertical-align: -0.379em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">T_s/T_{PWM}=2.45</script></span>).</li></ol><p>Ou seja, nossa rotina ISR para geração dos pontos da senoide poderia usar um simples contador inteiro para contar pontos de 0 até 9, sendo que a cada vez que ultrapassasse o valor 9, seu valor voltasse à zero. Este contador poderia ser usado como um apontador para a posição angular (vetor <code>theta</code>), ou este contador poderia ser usado para cálculo do ângulo atual no período da senoide, dado certo período de tempo passado. Note que nossa rotina ISR não vai criar nenhuma variável <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-23-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-235" style="width: 0.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.373em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.774em 1000em 2.731em -0.461em); top: -2.56em; left: 0em;"><span class="mrow" id="MathJax-Span-236"><span class="mi" id="MathJax-Span-237" style="font-family: MathJax_Math; font-style: italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.93em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">t</script></span>, nem necessita do vetor <code>theta</code>. Poderíamos simplesmente fazer algo como:</p><pre class="cpp hljs"><code class="cpp" data-origin="<pre><code class=&quot;cpp&quot;>ISR(TIMER2_COMPA_vect){
  y = 0;  // por default, duty-cycle de saída = 0%
  if (generate) {
    theta = index * delta_th;  // calcula angulo atual da senoide
    y = 128.0 + 128.0*sin(theta);
    index++; // deixa pronto para próximo ponto
    if (index &amp;gt; 9) index = 0;
  }
  analogWrite(pino_PWM, y);
}
</code></pre>">ISR(TIMER2_COMPA_vect){
  y = <span class="hljs-number">0</span>;  <span class="hljs-comment">// por default, duty-cycle de saída = 0%</span>
  <span class="hljs-keyword">if</span> (generate) {
    theta = index * delta_th;  <span class="hljs-comment">// calcula angulo atual da senoide</span>
    y = <span class="hljs-number">128.0</span> + <span class="hljs-number">128.0</span>*<span class="hljs-built_in">sin</span>(theta);
    index++; <span class="hljs-comment">// deixa pronto para próximo ponto</span>
    <span class="hljs-keyword">if</span> (index &gt; <span class="hljs-number">9</span>) index = <span class="hljs-number">0</span>;
  }
  analogWrite(pino_PWM, y);
}
</code></pre><p><strong>Obs.:</strong> mas atenção, a variável contadora neste caso, deveria ser global, ela não pode ser re-inicializada em zero (ou valor qualquer) à cada vez que o Arduíno executa a função acima. Por isto, algumas variáveis globais serão necessárias.</p><h3 id="configurando-a-isr-para-amostragem-da-senoide"><a name="configurando-a-isr-para-amostragem-da-senoide" href="#configurando-a-isr-para-amostragem-da-senoide"></a>Configurando a ISR para amostragem da Senoide</h3><p><strong><em>Referências consultadas:</em></strong></p><ul>
<li><a href="https://www.instructables.com/Arduino-Timer-Interrupts/">Instructables circuits: Arduino Timer Interrupts</a></li><li><a href="https://microcontrollerslab.com/arduino-timer-interrupts-tutorial/">https://microcontrollerslab.com/arduino-timer-interrupts-tutorial/</a></li><li><a href="https://forum.arduino.cc/t/resolved-timer2-how-to-set-the-frequency/22265">[RESOLVED] Timer2 - how to set the frequency</a></li></ul><p>Verificando que <em>timer</em>  do Arduíno se pode usar para trabalhar com:</p><ul>
<li>interrupção à <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-45-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-538" style="width: 4.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.787em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.855em 1000em 3.127em -0.425em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-539"><span class="msubsup" id="MathJax-Span-540"><span style="display: inline-block; position: relative; width: 0.975em; height: 0px;"><span style="position: absolute; clip: rect(1.695em 1000em 2.925em -0.425em); top: -2.56em; left: 0em;"><span class="mi" id="MathJax-Span-541" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span><span style="position: absolute; top: -2.213em; left: 0.527em;"><span class="mi" id="MathJax-Span-542" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span><span class="mo" id="MathJax-Span-543" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-544" style="font-family: MathJax_Main; padding-left: 0.278em;">400</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.324em; vertical-align: -0.376em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-45">f_s=400</script></span> Hz, para gerar os pontos da onda quadrada na freq <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-46-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-545" style="width: 3.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.88em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.855em 1000em 3.085em -0.425em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-546"><span class="mi" id="MathJax-Span-547" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-548" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-549" style="font-family: MathJax_Main; padding-left: 0.278em;">40</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.271em; vertical-align: -0.323em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-46">f=40</script></span> Hz. Alias, respeitando teorema da amostragem, deverímos gerar pontos numa “velocidade” <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-47-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-550" style="width: 2.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.027em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.397em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-551"><span class="mn" id="MathJax-Span-552" style="font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-553" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-47">10\times</script></span> maior, dai <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-48-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-554" style="width: 4.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.787em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.855em 1000em 3.127em -0.425em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-555"><span class="msubsup" id="MathJax-Span-556"><span style="display: inline-block; position: relative; width: 0.975em; height: 0px;"><span style="position: absolute; clip: rect(1.695em 1000em 2.925em -0.425em); top: -2.56em; left: 0em;"><span class="mi" id="MathJax-Span-557" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span><span style="position: absolute; top: -2.213em; left: 0.527em;"><span class="mi" id="MathJax-Span-558" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span><span class="mo" id="MathJax-Span-559" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-560" style="font-family: MathJax_Main; padding-left: 0.278em;">400</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.324em; vertical-align: -0.376em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-48">f_s=400</script></span> Hz. Verificar/calcular timers adequados para tanto.</li><li>Saída PWM: conferir que timers o sketch do Arduíno já reserva para saída PWM.</li></ul><p>Usando o <strong>pino 5 (<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-49-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-561" style="width: 8.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.04em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.855em 1000em 3.136em -0.425em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-562"><span class="msubsup" id="MathJax-Span-563"><span style="display: inline-block; position: relative; width: 2.575em; height: 0px;"><span style="position: absolute; clip: rect(1.695em 1000em 2.925em -0.425em); top: -2.56em; left: 0em;"><span class="mi" id="MathJax-Span-564" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span><span style="position: absolute; top: -2.213em; left: 0.527em;"><span class="texatom" id="MathJax-Span-565"><span class="mrow" id="MathJax-Span-566"><span class="mi" id="MathJax-Span-567" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mi" id="MathJax-Span-568" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.074em;"></span></span><span class="mi" id="MathJax-Span-569" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span><span class="mo" id="MathJax-Span-570" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-571" style="font-family: MathJax_Main; padding-left: 0.278em;">980</span><span class="mspace" id="MathJax-Span-572" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-573" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-574" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.334em; vertical-align: -0.387em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-49">f_{PWM}=980\; Hz</script></span>)</strong> do Arduíno para gerar o sinal PWM, temos que lembrar que o <strong>Timer0</strong> ficou comprometido com o gerador PWM. Necessitamos gerar uma interrupção por software para ocorrer a cada 400 Hz.</p><p>Descobrindo o valor de prescaler necessário…</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-50-Frame"><nobr><span class="math" id="MathJax-Span-575" style="width: 39.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 31.573em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(2.337em 1000em 5.056em -0.48em); top: -3.947em; left: 0em;"><span class="mrow" id="MathJax-Span-576"><span class="mtext" id="MathJax-Span-577" style="font-family: MathJax_Main;">Compare Match Reg</span><span class="mo" id="MathJax-Span-578" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-579" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mi" id="MathJax-Span-580" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mo" id="MathJax-Span-581" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mrow" id="MathJax-Span-582" style="padding-left: 0.278em;"><span class="mo" id="MathJax-Span-583" style="vertical-align: 0em; padding-left: 0.278em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mstyle" id="MathJax-Span-584"><span class="mrow" id="MathJax-Span-585"><span class="mfrac" id="MathJax-Span-586"><span style="display: inline-block; position: relative; width: 15.373em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.844em 1000em 3.074em -0.48em); top: -3.397em; left: 50%; margin-left: -4.293em;"><span class="mtext" id="MathJax-Span-587" style="font-family: MathJax_Main;">Arduino Clock Freq</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; clip: rect(1.866em 1000em 3.074em -0.519em); top: -2.034em; left: 50%; margin-left: -7.627em;"><span class="mrow" id="MathJax-Span-588"><span class="mi" id="MathJax-Span-589" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-590" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-591" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-592" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-593" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-594" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-595" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-596" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-597" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mo" id="MathJax-Span-598" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="texatom" id="MathJax-Span-599" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-600"><span class="mi" id="MathJax-Span-601" style="font-family: MathJax_Math; font-style: italic;">D</span><span class="mi" id="MathJax-Span-602" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-603" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-604" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-605" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-606" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-607" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-608" style="font-family: MathJax_Math; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mi" id="MathJax-Span-609" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-610" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-611" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-612" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-613" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-614" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mi" id="MathJax-Span-615" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-616" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-617" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-618" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-619" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-620" style="font-family: MathJax_Math; font-style: italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; clip: rect(0.84em 1000em 1.227em -0.48em); top: -1.287em; left: 0em;"><span style="border-left-width: 15.373em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.067em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-621" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mo" id="MathJax-Span-622" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-623" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.947em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.132em; vertical-align: -1.254em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-50">
\text{Compare Match Reg}, CM = \left( \dfrac{\text{Arduino Clock Freq}}{prescaler \times {Desired Interrupt Freq}} \right) -1</script><p></p><p>Lembrando que: O <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-51-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-624" style="width: 0.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.64em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.958em 1000em 2.936em -0.457em); top: -2.56em; left: 0em;"><span class="mrow" id="MathJax-Span-625"><span class="mi" id="MathJax-Span-626" style="font-family: MathJax_Math; font-style: italic;">μ</span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.956em; vertical-align: -0.337em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-51">\mu</script></span>C ATMEL 328/168 do Arduíno permite definir o prescaler apenas nos valores fixos: 1, 8, 64, 256 e 1024.</p><pre class="matlab hljs"><code class="Matlab" data-origin="<pre><code class=&quot;Matlab&quot;>&amp;gt;&amp;gt; prescaler=[1 8 64 256 1024]; % valores padrões do Arduino
&amp;gt;&amp;gt; CM=(16E6./(prescaler.*400)-1);
&amp;gt;&amp;gt; [prescaler' CM']
ans =
            1        39999
            8         4999
           64          624
          256       155.25
         1024       38.063
</code></pre>">&gt;&gt; prescaler=<span class="hljs-matrix">[<span class="hljs-number">1</span> <span class="hljs-number">8</span> <span class="hljs-number">64</span> <span class="hljs-number">256</span> <span class="hljs-number">1024</span>]</span>; <span class="hljs-comment">% valores padrões do Arduino</span>
&gt;&gt; CM=(<span class="hljs-number">16E6</span>./(prescaler.*<span class="hljs-number">400</span>)-<span class="hljs-number">1</span>);
&gt;&gt; <span class="hljs-matrix">[prescaler<span class="hljs-string">' CM'</span>]</span>
<span class="hljs-built_in">ans</span> =
            <span class="hljs-number">1</span>        <span class="hljs-number">39999</span>
            <span class="hljs-number">8</span>         <span class="hljs-number">4999</span>
           <span class="hljs-number">64</span>          <span class="hljs-number">624</span>
          <span class="hljs-number">256</span>       <span class="hljs-number">155.25</span>
         <span class="hljs-number">1024</span>       <span class="hljs-number">38.063</span>
</code></pre><p>Considerações sobre o prescaler e timer à ser usado:</p><ul>
<li>O Timer0 que é de 8 bits já está ocupado;</li><li>O Timer1 (ainda livre) é de 16 bits e poderia ser usado.</li><li><p>O Timer2 (ainda livre) é de 8 bits e teríamos que usar <code>prescaler = 256</code> (bits de CS2<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-52-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-627" style="width: 8.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.773em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.894em 1000em 3.243em -0.424em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-628"><span class="mo" id="MathJax-Span-629" style="font-family: MathJax_Main;">=</span><span class="msubsup" id="MathJax-Span-630" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.888em; height: 0px;"><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.438em); top: -2.72em; left: 0em;"><span class="mn" id="MathJax-Span-631" style="font-family: MathJax_Main;">6</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; top: -2.321em; left: 0.533em;"><span class="texatom" id="MathJax-Span-632"><span class="mrow" id="MathJax-Span-633"><span class="mo" id="MathJax-Span-634" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-635" style="font-size: 70.7%; font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-636" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.507em;"></span></span></span></span><span class="mo" id="MathJax-Span-637" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-638" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.528em; height: 0px;"><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.397em); top: -2.72em; left: 0em;"><span class="mn" id="MathJax-Span-639" style="font-family: MathJax_Main;">110</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; top: -2.321em; left: 1.547em;"><span class="texatom" id="MathJax-Span-640"><span class="mrow" id="MathJax-Span-641"><span class="mo" id="MathJax-Span-642" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-643" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-644" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.507em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.419em; vertical-align: -0.52em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-52">=6_{(10)}=110_{(2)}</script></span>, ajustados como: CS22:1, CS21=1 e CS20=0).</p>
<p>Resta definir o valor do Timer2 em 155 (registrador OCR2A).</p>
<p>Neste caso, obteríamos a frequência de amostragem para senoide em:</p>
<pre class="matlab hljs"><code class="Matlab" data-origin="<pre><code class=&quot;Matlab&quot;>&amp;gt;&amp;gt; Interrupt_freq=16E6/(256*(155+1))
Interrupt_freq =
     400.64
</code></pre>">&gt;&gt; Interrupt_freq=<span class="hljs-number">16E6</span>/(<span class="hljs-number">256</span>*(<span class="hljs-number">155</span>+<span class="hljs-number">1</span>))
Interrupt_freq =
     <span class="hljs-number">400.64</span>
</code></pre>
</li></ul><h2 id="interface-com-usuário"><a name="interface-com-usuário" href="#interface-com-usuário"></a>Interface com Usuário</h2><p>A questão é: — como vamos indicar ao Arduino quando o mesmo deve gerar a onda quadrada e quando ele deve “pausar” a onda quadrada?</p><p>Podemos acrescentar um botão (push-button) que simplesmente alterna o estado do do sistema entre: [true]=gerar senoide/[false]=parar de gerar senoide. Apertar este botão faz simplesmente o sistema alternar entre estes 2 estados.</p><p>Mas seria interessante indicar o “status” atual do sistema, para o usuário, de forma a que o mesmo se dê conta se a placa estã no modo “pause” (não gerar onda) ou no modo “gerar onda senoidal”. A ideia então é usar 3 leds que alternam entre 2 situações:</p><ol>
<li>Quando estiver no modo “pause”, os leds simplesmente piscam, indicando que o sistema está esperando “liberação” por parte do usuário.</li><li>Quando o sistema está no modo gerar onda senoidal, um efeito visual de vai-e-vêm é gerado sobre os 3 leds da placa.</li></ol><p>Segue código exemplo/teste da interface com usuário:</p><pre class="cpp hljs"><code class="cpp" data-origin="<pre><code class=&quot;cpp&quot;>/****************************************************************
Teste interface saída

Fernando Passold, em 16/11/2022
*****************************************************************/
// Led 1, pin 2, active HIGH
// Led 2, pin 3, active HIGH
// Led 3, pin 4, active HIGH
#define pino_ESC  7  /* botão para ligar/desligar senoide, push-buttom active LOW */

// Seguem variáveis associadas com &quot;interface de saída&quot;
byte pinos_Leds[]={2,3,4};  // vetor que define pinos onde leds estão conectados
int  Leds;                  // descobre quantidade de leds, calculado em tempo de execução
int  led_ativo  = 0;        // indicador do led atual ativo na &quot;interface de saída&quot;
int  dir = 1;               // direção do movimento do led (+1 ou -1)
bool generate   = true;     // indicar gerar/não-gerar senoide
bool debouncing = false;    // realizando debouncing da chave ou não
bool blink      = false;    // indica quando leds para interface piscam ou não
                            // a ideia é que pisquem quando NÂO estamos gerando a senoide
unsigned long currentMillis = 0;          // &quot;tempo&quot;  atual do sistema
unsigned long previousMillis = 0;         // will store last time leds was updated
unsigned long time_pressed = 0;           // will store last time buttom was pressed
const unsigned long time_debounce = 150;  // periodo de tempo para debouncing de chave (milisegundos)
const unsigned long time_wait = 250;      // interval at which to change leds states (milliseconds)

void turn_off_leds() {
  // simplesmente apaga todos os leds da &quot;interface de saida&quot;
  for (byte i=0; i &amp;lt; Leds; i++){
    digitalWrite(pinos_Leds[i], HIGH);
  }
}

void turn_on_all_leds() {
  // simplesmemte ativa todos os leds da &quot;interface de saída&quot;
  for (byte i=0; i &amp;lt; Leds; i++){
    digitalWrite(pinos_Leds[i], LOW);
  }
}

void activate_next_led() {
  // ativa leds da &quot;interface de saída&quot; sequencialmente
  // usa variavel global led_ativo para saber qual led atualmente está ativo
  Serial.print(&quot;led_ativo=&quot;); Serial.print(led_ativo);
  Serial.print(&quot;\tdir=&quot;); Serial.println(dir);
  for (byte i=0; i &amp;lt; Leds; i++){
    if (i == led_ativo) digitalWrite(pinos_Leds[i], HIGH);
    else digitalWrite(pinos_Leds[i], LOW);
  }
  // deixa preparadao para próxima chamada
  led_ativo = led_ativo + dir;
  if (led_ativo &amp;gt;= Leds) {
    led_ativo = Leds-2;
    dir = -1;
  }
  if (led_ativo &amp;lt; 0) {
    led_ativo = 1;
    dir = 1;
  }
}

void init_vars(){
  // inicializa variáveis importantes
  previousMillis = millis();
  generate    = false;
  debouncing  = false;
  blink       = false;
  led_ativo   = 0;
  dir         = 1;  
}

void update_leds(){
  // atualiza interface de saida conforme &quot;status&quot; do sistema
  if (currentMillis - previousMillis &amp;gt;= time_wait) {
    // save the last time you blinked the LED
    previousMillis = currentMillis;
    if (generate) {
      activate_next_led();
    } 
    else 
    {
      blink = !blink;
      if (blink) turn_on_all_leds();
      else turn_off_leds();
    }
  }  
}

void setup() {
  Leds = sizeof(pinos_Leds) / sizeof(byte); // descobre quantidade de leds usados
  for (byte i=0; i &amp;lt;= Leds; i++){
    pinMode(pinos_Leds[i], OUTPUT);
    digitalWrite(pinos_Leds[i], HIGH);
  }
  pinMode(pino_ESC, INPUT);   // botão ESC

  turn_off_leds();

  Serial.begin(9600); // depois tentar aumentar para 115 Kbps
  // Serial.begin(115200);
  delay(100);
  Serial.print(&quot;\nLeds=&quot;); Serial.println(Leds);
  turn_off_leds();
  init_vars();
  Serial.println(&quot;Setup-Start done...\n&quot;);
} // end setup()

void loop() {
  currentMillis = millis();   // atualizando esta variável
  update_leds(); // atualiza interface de saída (leds)
  // lê botão ESC para alternar gerar/não-generar senoide mas apenas fora do periodo do debouncing
  if (!debouncing) {
    if (digitalRead(pino_ESC) == LOW) {
      // deveria deixar passar uns 50 ~ 100 ms a titulo de debouncing do botão
      // não podemos usar delay(100) porque influencia função analogWrite() - gerador PWM &quot;interno&quot; do Arduino
      debouncing = true;
      time_pressed = millis();
      generate = !generate;  // simplesmente alterna estado
      // atualiza info e variaveis para nova condição
      if (generate) {
        Serial.println(&quot;Generating sine wave...&quot;);
        led_ativo = 0;  // reinicia interface de saida
      } else {
        Serial.println(&quot;NOT generating sine wave (pause)...&quot;);
      }
    }
  }
  if (debouncing) {
    // Significa que estamos dentro de periodo de debouncing em que a chave é ignorada
    // falta verificar se passou tempo para &quot;desligar&quot; o debouncing
    if (currentMillis - time_pressed &amp;gt;= time_debounce) {
      debouncing = false;  // habilita novas leituras do botão
    }
  }
}  // end loop()
</code></pre>"><span class="hljs-comment">/****************************************************************
Teste interface saída

Fernando Passold, em 16/11/2022
*****************************************************************/</span>
<span class="hljs-comment">// Led 1, pin 2, active HIGH</span>
<span class="hljs-comment">// Led 2, pin 3, active HIGH</span>
<span class="hljs-comment">// Led 3, pin 4, active HIGH</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> pino_ESC  7  /* botão para ligar/desligar senoide, push-buttom active LOW */</span>

<span class="hljs-comment">// Seguem variáveis associadas com "interface de saída"</span>
byte pinos_Leds[]={<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>};  <span class="hljs-comment">// vetor que define pinos onde leds estão conectados</span>
<span class="hljs-keyword">int</span>  Leds;                  <span class="hljs-comment">// descobre quantidade de leds, calculado em tempo de execução</span>
<span class="hljs-keyword">int</span>  led_ativo  = <span class="hljs-number">0</span>;        <span class="hljs-comment">// indicador do led atual ativo na "interface de saída"</span>
<span class="hljs-keyword">int</span>  dir = <span class="hljs-number">1</span>;               <span class="hljs-comment">// direção do movimento do led (+1 ou -1)</span>
<span class="hljs-keyword">bool</span> generate   = <span class="hljs-keyword">true</span>;     <span class="hljs-comment">// indicar gerar/não-gerar senoide</span>
<span class="hljs-keyword">bool</span> debouncing = <span class="hljs-keyword">false</span>;    <span class="hljs-comment">// realizando debouncing da chave ou não</span>
<span class="hljs-keyword">bool</span> blink      = <span class="hljs-keyword">false</span>;    <span class="hljs-comment">// indica quando leds para interface piscam ou não</span>
                            <span class="hljs-comment">// a ideia é que pisquem quando NÂO estamos gerando a senoide</span>
<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> currentMillis = <span class="hljs-number">0</span>;          <span class="hljs-comment">// "tempo"  atual do sistema</span>
<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previousMillis = <span class="hljs-number">0</span>;         <span class="hljs-comment">// will store last time leds was updated</span>
<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> time_pressed = <span class="hljs-number">0</span>;           <span class="hljs-comment">// will store last time buttom was pressed</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> time_debounce = <span class="hljs-number">150</span>;  <span class="hljs-comment">// periodo de tempo para debouncing de chave (milisegundos)</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> time_wait = <span class="hljs-number">250</span>;      <span class="hljs-comment">// interval at which to change leds states (milliseconds)</span>

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">turn_off_leds</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-comment">// simplesmente apaga todos os leds da "interface de saida"</span>
  <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">0</span>; i &lt; Leds; i++){
    digitalWrite(pinos_Leds[i], HIGH);
  }
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">turn_on_all_leds</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-comment">// simplesmemte ativa todos os leds da "interface de saída"</span>
  <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">0</span>; i &lt; Leds; i++){
    digitalWrite(pinos_Leds[i], LOW);
  }
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">activate_next_led</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-comment">// ativa leds da "interface de saída" sequencialmente</span>
  <span class="hljs-comment">// usa variavel global led_ativo para saber qual led atualmente está ativo</span>
  Serial.print(<span class="hljs-string">"led_ativo="</span>); Serial.print(led_ativo);
  Serial.print(<span class="hljs-string">"\tdir="</span>); Serial.println(dir);
  <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">0</span>; i &lt; Leds; i++){
    <span class="hljs-keyword">if</span> (i == led_ativo) digitalWrite(pinos_Leds[i], HIGH);
    <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">digitalWrite</span><span class="hljs-params">(pinos_Leds[i], LOW)</span></span>;
  }
  <span class="hljs-comment">// deixa preparadao para próxima chamada</span>
  led_ativo = led_ativo + dir;
  <span class="hljs-keyword">if</span> (led_ativo &gt;= Leds) {
    led_ativo = Leds-<span class="hljs-number">2</span>;
    dir = -<span class="hljs-number">1</span>;
  }
  <span class="hljs-keyword">if</span> (led_ativo &lt; <span class="hljs-number">0</span>) {
    led_ativo = <span class="hljs-number">1</span>;
    dir = <span class="hljs-number">1</span>;
  }
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init_vars</span><span class="hljs-params">()</span></span>{
  <span class="hljs-comment">// inicializa variáveis importantes</span>
  previousMillis = millis();
  generate    = <span class="hljs-keyword">false</span>;
  debouncing  = <span class="hljs-keyword">false</span>;
  blink       = <span class="hljs-keyword">false</span>;
  led_ativo   = <span class="hljs-number">0</span>;
  dir         = <span class="hljs-number">1</span>;  
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">update_leds</span><span class="hljs-params">()</span></span>{
  <span class="hljs-comment">// atualiza interface de saida conforme "status" do sistema</span>
  <span class="hljs-keyword">if</span> (currentMillis - previousMillis &gt;= time_wait) {
    <span class="hljs-comment">// save the last time you blinked the LED</span>
    previousMillis = currentMillis;
    <span class="hljs-keyword">if</span> (generate) {
      activate_next_led();
    } 
    <span class="hljs-keyword">else</span> 
    {
      blink = !blink;
      <span class="hljs-keyword">if</span> (blink) turn_on_all_leds();
      <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">turn_off_leds</span><span class="hljs-params">()</span></span>;
    }
  }  
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{
  Leds = <span class="hljs-keyword">sizeof</span>(pinos_Leds) / <span class="hljs-keyword">sizeof</span>(byte); <span class="hljs-comment">// descobre quantidade de leds usados</span>
  <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">0</span>; i &lt;= Leds; i++){
    pinMode(pinos_Leds[i], OUTPUT);
    digitalWrite(pinos_Leds[i], HIGH);
  }
  pinMode(pino_ESC, INPUT);   <span class="hljs-comment">// botão ESC</span>

  turn_off_leds();

  Serial.begin(<span class="hljs-number">9600</span>); <span class="hljs-comment">// depois tentar aumentar para 115 Kbps</span>
  <span class="hljs-comment">// Serial.begin(115200);</span>
  delay(<span class="hljs-number">100</span>);
  Serial.print(<span class="hljs-string">"\nLeds="</span>); Serial.println(Leds);
  turn_off_leds();
  init_vars();
  Serial.println(<span class="hljs-string">"Setup-Start done...\n"</span>);
} <span class="hljs-comment">// end setup()</span>

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{
  currentMillis = millis();   <span class="hljs-comment">// atualizando esta variável</span>
  update_leds(); <span class="hljs-comment">// atualiza interface de saída (leds)</span>
  <span class="hljs-comment">// lê botão ESC para alternar gerar/não-generar senoide mas apenas fora do periodo do debouncing</span>
  <span class="hljs-keyword">if</span> (!debouncing) {
    <span class="hljs-keyword">if</span> (digitalRead(pino_ESC) == LOW) {
      <span class="hljs-comment">// deveria deixar passar uns 50 ~ 100 ms a titulo de debouncing do botão</span>
      <span class="hljs-comment">// não podemos usar delay(100) porque influencia função analogWrite() - gerador PWM "interno" do Arduino</span>
      debouncing = <span class="hljs-keyword">true</span>;
      time_pressed = millis();
      generate = !generate;  <span class="hljs-comment">// simplesmente alterna estado</span>
      <span class="hljs-comment">// atualiza info e variaveis para nova condição</span>
      <span class="hljs-keyword">if</span> (generate) {
        Serial.println(<span class="hljs-string">"Generating sine wave..."</span>);
        led_ativo = <span class="hljs-number">0</span>;  <span class="hljs-comment">// reinicia interface de saida</span>
      } <span class="hljs-keyword">else</span> {
        Serial.println(<span class="hljs-string">"NOT generating sine wave (pause)..."</span>);
      }
    }
  }
  <span class="hljs-keyword">if</span> (debouncing) {
    <span class="hljs-comment">// Significa que estamos dentro de periodo de debouncing em que a chave é ignorada</span>
    <span class="hljs-comment">// falta verificar se passou tempo para "desligar" o debouncing</span>
    <span class="hljs-keyword">if</span> (currentMillis - time_pressed &gt;= time_debounce) {
      debouncing = <span class="hljs-keyword">false</span>;  <span class="hljs-comment">// habilita novas leituras do botão</span>
    }
  }
}  <span class="hljs-comment">// end loop()</span>
</code></pre><p>Referência consultada:</p><ul>
<li><a href="https://docs.arduino.cc/built-in-examples/digital/BlinkWithoutDelay">https://docs.arduino.cc/built-in-examples/digital/BlinkWithoutDelay</a></li></ul><h2 id="transmissão-serial-de-dados"><a name="transmissão-serial-de-dados" href="#transmissão-serial-de-dados"></a>Transmissão serial de dados</h2><p>Também queremos transmitir dados pela porta serial do Arduino (TX = <strong>pin 1</strong>, RX = <strong>pin 0</strong>).</p><p>A porta serial seria trabalha na forma:</p><pre class="cpp hljs"><code class="cpp" data-origin="<pre><code class=&quot;cpp&quot;>void setup() {
  // open a serial connection
  Serial.begin(9600); // mudar para 115200 baud
  while (!SerialUSB); // sugerido para esperar abertura da porta serial com PC
}

void loop() {
  Serial.write(45); // send a byte with the value 45

  int bytesSent = Serial.write(&quot;hello&quot;);  //send the string &quot;hello&quot; and return the length of the string.
}
</code></pre>"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-comment">// open a serial connection</span>
  Serial.begin(<span class="hljs-number">9600</span>); <span class="hljs-comment">// mudar para 115200 baud</span>
  <span class="hljs-keyword">while</span> (!SerialUSB); <span class="hljs-comment">// sugerido para esperar abertura da porta serial com PC</span>
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{
  Serial.write(<span class="hljs-number">45</span>); <span class="hljs-comment">// send a byte with the value 45</span>

  <span class="hljs-keyword">int</span> bytesSent = Serial.write(<span class="hljs-string">"hello"</span>);  <span class="hljs-comment">//send the string "hello" and return the length of the string.</span>
}
</code></pre><p><strong>Observações</strong>:</p><ul>
<li><code>Serial.print()</code>:<br>Escreve na serial texto em formato  ASCII. Números inteiros são escritos usando um caractere ASCII para cada dígito. O mesmo ocorre para números flutuante e, por padrão, são escritos com duas casas decimais. Bytes são enviados como caracteres únicos e strings e caracteres são enviados como caracteres únicos (Ver <a href="https://embarcados.com.br/arduino-comunicacao-serial/">Embarcados: Arduino – Comunicação Serial</a>).</li><li>Outro detalhe: estas funções ocupam um buffer de apenas 64 bytes para transmissões assíncronas de dados.</li></ul><h3 id="a-função-`analogwrite()`"><a name="a-função-`analogwrite()`" href="#a-função-`analogwrite()`"></a>A função <code>analogWrite()</code></h3><p>A função <a href="https://www.arduino.cc/reference/en/language/functions/analog-io/analogwrite/"><code>analogWrite()</code></a> não gera realmente um sinal analógico e sim um sinal PWM nos pinos 3, 5, 6, 9, 10 e 11.</p><p>No nosso caso, usaremos o pino 5 (ou 6), o código para esta função deveria ficar algo semelhante à:</p><pre class="cpp hljs"><code class="cpp" data-origin="<pre><code class=&quot;cpp&quot;>int ledPWM = 5;      // ou pino 6

void setup() {
  // Note: não é necessário definir como OUTPUT, pinos usados com algum PWM
  // a menos que se queria colocar um led neste pino para testar
  // visualmente o resultado da modulação PWM
  pinMode(ledPWM, OUTPUT);  // sets the pin as output
}

void loop() {
  analogWrite(ledPWM, valor); // valor = 0 (0%) até 255 (100%)
}
</code></pre>"><span class="hljs-keyword">int</span> ledPWM = <span class="hljs-number">5</span>;      <span class="hljs-comment">// ou pino 6</span>

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-comment">// Note: não é necessário definir como OUTPUT, pinos usados com algum PWM</span>
  <span class="hljs-comment">// a menos que se queria colocar um led neste pino para testar</span>
  <span class="hljs-comment">// visualmente o resultado da modulação PWM</span>
  pinMode(ledPWM, OUTPUT);  <span class="hljs-comment">// sets the pin as output</span>
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{
  analogWrite(ledPWM, valor); <span class="hljs-comment">// valor = 0 (0%) até 255 (100%)</span>
}
</code></pre><h2 id="versão-final"><a name="versão-final" href="#versão-final"></a>Versão final</h2><p>Segue diagrama elétrico da montagem:</p><p><img src="figuras/gerador_senoidal_arduino.drawio.jpg" alt="gerador_senoidal_arduino.drawio.jpg"></p><p>Segue pinagem do led e do push-button:</p><table>
<thead>
<tr>
<th style="text-align:center">Pinagem do led</th>
<th style="text-align:center">Pinos push-button</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img src="figuras/led_3.jpg" alt="led_3.jpg"></td>
<td style="text-align:center"><img src="figuras/uso_push_button_na.png" alt="uso_push_button_na.png"></td>
</tr>
</tbody>
</table><p>Segue versão final do código <code>senoide.ino</code>:</p><pre class="cpp hljs"><code class="cpp" data-origin="<pre><code class=&quot;cpp&quot;>/****************************************************************
Teste interface saída

Fernando Passold, em 16/11/2022
*****************************************************************/
// Led 1, active HIGH
// Led 2, active HIGH
// Led 3, active HIGH
// Pin 5 = time-consuming ISR verifying with osciloscope
// Pin 6 = PWM output
#define pino_ESC  7                           // botão para ligar/desligar senoide, push-buttom active LOW
#define pino_PWM 6                            // saida PWM à 980 Hz (apenas pinos 5 e 6), uso com analogWrite()
#define pino_monitor 5                        // apenas para monitorar dutty-cycle da rotina de ISR (usar osciloscópio)

// Seguem variaveis associadas com &quot;interface de saída&quot;
byte pinos_Leds[]={2,3,4};
int  Leds; // define quantidade de leds, calculado em tempo de execução
int  led_ativo  = 0;      // indicador do led atual ativo na &quot;interface de saída&quot;
int  dir = 1;             // direção do movimento do led (+1 ou -1)
bool generate   = true;   // indica gerar/não-gerar senoide
bool debouncing = false;
bool blink      = false;  // indica quando leds para interface piscam ou não
                          // a ideia é que pisquem quando NÂO estamos gerando a senoide
unsigned long currentMillis = 0;
unsigned long previousMillis = 0;         // will store last time leds was updated
unsigned long time_pressed = 0;           // will store last time buttom was pressed
const unsigned long time_debounce = 150;  // periodo de tempo para debouncing de chave (milisegundos)
const unsigned long time_wait = 250;      // interval at which to change leds states (milliseconds)

// Seguem variáveis relacionadas com geração da senoide 40 Hz
int index = 0; // ponto da senoide sendo sintetizado
const float delta_th = 2.0 * PI / 10.0;  // incremento angular entre os 10 pontos da senoide
// resulta em: delta_th = 0.63 (0,6283185307179586476925286766559)
float theta; // angulo atual da senoide
float y; // amplitude da senoide

void turn_off_leds() {
  // simplesmente apaga todos os leds da &quot;interface de saida&quot;
  for (byte i=0; i &amp;lt; Leds; i++){
    digitalWrite(pinos_Leds[i], HIGH);
  }
}

void turn_on_all_leds() {
  // simplesmemte ativa todos os leds da &quot;interface de saída&quot;
  for (byte i=0; i &amp;lt; Leds; i++){
    digitalWrite(pinos_Leds[i], LOW);
  }
}

void activate_next_led() {
  // ativa leds da &quot;interface de saída&quot; sequencialmente
  // usa variavel global led_ativo para saber qual led atualmente está ativo
  Serial.print(&quot;y=&quot;); Serial.print(y);
  Serial.print(&quot;\tled_ativo=&quot;);
  Serial.print(led_ativo);
  Serial.print(&quot;\tdir=&quot;);
  Serial.println(dir);
  for (byte i=0; i &amp;lt; Leds; i++){
    if (i == led_ativo) digitalWrite(pinos_Leds[i], HIGH);
    else digitalWrite(pinos_Leds[i], LOW);
  }
  // deixa preparadao para próxima chamada
  led_ativo = led_ativo + dir;
  if (led_ativo &amp;gt;= Leds) {
    led_ativo = Leds-2;
    dir = -1;
  }
  if (led_ativo &amp;lt; 0) {
    led_ativo = 1;
    dir = 1;
  }
}

void init_vars(){
  previousMillis = millis();
  generate    = false;
  debouncing  = false;
  blink       = false;
  led_ativo   = 0;
  dir = 1;    // direção &quot;movimento&quot; dos leds (+1 ou -1)
  index = 0;  // ponto inicial da senoide  
}

void update_leds(){
  // atualiza interface de saida conforme &quot;status&quot; do sistema
  if (currentMillis - previousMillis &amp;gt;= time_wait) {
    // save the last time you blinked the LED
    previousMillis = currentMillis;
    if (generate) {
      activate_next_led();
    } 
    else 
    {
      blink = !blink;
      if (blink) turn_on_all_leds();
      else turn_off_leds();
    }
  }  
}

//  Segue codigo da ISR que gera os pontos da senoide
ISR(TIMER2_COMPA_vect){
  digitalWrite(pino_monitor, HIGH); // enters on ISR
  y = 0;  // por default, duty-cycle de saída = 0%
  if (generate) {
    theta = index * delta_th;  // calcula angulo atual da senoide
    y = 128.0 + 128.0*sin(theta);
    index++; // deixa pronto para proximo ponto
    if (index &amp;gt; 9) index = 0;
  }
  analogWrite(pino_PWM, y);
  digitalWrite(pino_monitor, LOW);  // get out from ISR
}

void setup() {
  // put your setup code here, to run once:
  Leds = sizeof(pinos_Leds) / sizeof(byte);
  for (byte i=0; i&amp;lt;Leds; i++){
    pinMode(pinos_Leds[i], OUTPUT);
    digitalWrite(pinos_Leds[i], HIGH);
  }
  pinMode(pino_ESC, INPUT);   // botão ESC
  pinMode(pino_PWM, OUTPUT);
  pinMode(pino_monitor, OUTPUT);

  Serial.begin(9600); // depois tentar aumentar para 115 Kbps
  // Serial.begin(115200);
  delay(100);
  Serial.println(&quot;Setup&quot;);
  Serial.print(&quot;\tLeds = &quot;); Serial.println(Leds);
  Serial.print(&quot;\tPI = &quot;); Serial.println(PI);
  Serial.print(&quot;\tdelta_th = &quot;); Serial.println(delta_th);
  Serial.println(&quot;\tConfiguring ISR using timer2...&quot;);

  // configurando inicialização do timer2 usado para a ISR
  cli();        //stop interrupts
  TCCR2A = 0;   // set entire TCCR2A register to 0
  TCCR2B = 0;   // same for TCCR2B
  TCNT2 = 0;    // initialize counter value to 0
  // set timer2 interrupt at 400 Hz
  // set compare match register for 400 Hz increments:
  OCR2A = 155;  // = (16*10^6) / (400*256) - 1 (must be &amp;lt;256)
  // set CS prescaler for timer2 to 256 (CS2:0)=6(10)=110(2):
  TCCR2B |= (1 &amp;lt;&amp;lt; CS22) | (1 &amp;lt;&amp;lt; CS21) | (0 &amp;lt;&amp;lt; CS20);
  TCCR2A |= (1 &amp;lt;&amp;lt; WGM21);   // turn on CTC mode for timer2
  TIMSK2 |= (1 &amp;lt;&amp;lt; OCIE2A);  // enable timer compare interrupt
  sei();                    //allow interrupts 
  // fim configuração ISR

  turn_off_leds();
  init_vars();
  Serial.println(&quot;Setup done...\n&quot;);
} // end setup()

void loop() {
  currentMillis = millis();   // atualizando esta variável
  update_leds(); // atualiza interface de saída (leds)
  // lê botão ESC para alternar gerar/não-generar senoide mas apenas fora do periodo do debouncing
  if (!debouncing) {
    if (digitalRead(pino_ESC) == LOW) {
      // deveria deixar passar uns 50 ~ 100 ms a titulo de debouncing do botão
      // não podemos usar delay(100) porque influencia função analogWrite() - gerador PWM &quot;interno&quot; do Arduino
      debouncing = true;
      time_pressed = millis();
      generate = !generate;  // simplesmente alterna estado
      // atualiza info e variaveis para nova condição
      if (generate) {
        index = 0;      // reinicia senoide
        Serial.println(&quot;Generating sine wave...&quot;);
        led_ativo = 0;  // reinicia interface de saida
      } else {
        Serial.println(&quot;NOT generating sine wave (pause)...&quot;);
      }
    }
  }
  if (debouncing) {
    // Significa que estamos dentro de periodo de debouncing em que a chave é ignorada
    // falta verificar se passou tempo para &quot;desligar&quot; o debouncing
    if (currentMillis - time_pressed &amp;gt;= time_debounce) {
      debouncing = false;  // habilita novas leituras do botão
    }
  }
}  // end loop()
</code></pre>"><span class="hljs-comment">/****************************************************************
Teste interface saída

Fernando Passold, em 16/11/2022
*****************************************************************/</span>
<span class="hljs-comment">// Led 1, active HIGH</span>
<span class="hljs-comment">// Led 2, active HIGH</span>
<span class="hljs-comment">// Led 3, active HIGH</span>
<span class="hljs-comment">// Pin 5 = time-consuming ISR verifying with osciloscope</span>
<span class="hljs-comment">// Pin 6 = PWM output</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> pino_ESC  7                           <span class="hljs-comment">// botão para ligar/desligar senoide, push-buttom active LOW</span></span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> pino_PWM 6                            <span class="hljs-comment">// saida PWM à 980 Hz (apenas pinos 5 e 6), uso com analogWrite()</span></span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> pino_monitor 5                        <span class="hljs-comment">// apenas para monitorar dutty-cycle da rotina de ISR (usar osciloscópio)</span></span>

<span class="hljs-comment">// Seguem variaveis associadas com "interface de saída"</span>
byte pinos_Leds[]={<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>};
<span class="hljs-keyword">int</span>  Leds; <span class="hljs-comment">// define quantidade de leds, calculado em tempo de execução</span>
<span class="hljs-keyword">int</span>  led_ativo  = <span class="hljs-number">0</span>;      <span class="hljs-comment">// indicador do led atual ativo na "interface de saída"</span>
<span class="hljs-keyword">int</span>  dir = <span class="hljs-number">1</span>;             <span class="hljs-comment">// direção do movimento do led (+1 ou -1)</span>
<span class="hljs-keyword">bool</span> generate   = <span class="hljs-keyword">true</span>;   <span class="hljs-comment">// indica gerar/não-gerar senoide</span>
<span class="hljs-keyword">bool</span> debouncing = <span class="hljs-keyword">false</span>;
<span class="hljs-keyword">bool</span> blink      = <span class="hljs-keyword">false</span>;  <span class="hljs-comment">// indica quando leds para interface piscam ou não</span>
                          <span class="hljs-comment">// a ideia é que pisquem quando NÂO estamos gerando a senoide</span>
<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> currentMillis = <span class="hljs-number">0</span>;
<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previousMillis = <span class="hljs-number">0</span>;         <span class="hljs-comment">// will store last time leds was updated</span>
<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> time_pressed = <span class="hljs-number">0</span>;           <span class="hljs-comment">// will store last time buttom was pressed</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> time_debounce = <span class="hljs-number">150</span>;  <span class="hljs-comment">// periodo de tempo para debouncing de chave (milisegundos)</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> time_wait = <span class="hljs-number">250</span>;      <span class="hljs-comment">// interval at which to change leds states (milliseconds)</span>

<span class="hljs-comment">// Seguem variáveis relacionadas com geração da senoide 40 Hz</span>
<span class="hljs-keyword">int</span> index = <span class="hljs-number">0</span>; <span class="hljs-comment">// ponto da senoide sendo sintetizado</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> delta_th = <span class="hljs-number">2.0</span> * PI / <span class="hljs-number">10.0</span>;  <span class="hljs-comment">// incremento angular entre os 10 pontos da senoide</span>
<span class="hljs-comment">// resulta em: delta_th = 0.63 (0,6283185307179586476925286766559)</span>
<span class="hljs-keyword">float</span> theta; <span class="hljs-comment">// angulo atual da senoide</span>
<span class="hljs-keyword">float</span> y; <span class="hljs-comment">// amplitude da senoide</span>

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">turn_off_leds</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-comment">// simplesmente apaga todos os leds da "interface de saida"</span>
  <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">0</span>; i &lt; Leds; i++){
    digitalWrite(pinos_Leds[i], HIGH);
  }
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">turn_on_all_leds</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-comment">// simplesmemte ativa todos os leds da "interface de saída"</span>
  <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">0</span>; i &lt; Leds; i++){
    digitalWrite(pinos_Leds[i], LOW);
  }
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">activate_next_led</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-comment">// ativa leds da "interface de saída" sequencialmente</span>
  <span class="hljs-comment">// usa variavel global led_ativo para saber qual led atualmente está ativo</span>
  Serial.print(<span class="hljs-string">"y="</span>); Serial.print(y);
  Serial.print(<span class="hljs-string">"\tled_ativo="</span>);
  Serial.print(led_ativo);
  Serial.print(<span class="hljs-string">"\tdir="</span>);
  Serial.println(dir);
  <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">0</span>; i &lt; Leds; i++){
    <span class="hljs-keyword">if</span> (i == led_ativo) digitalWrite(pinos_Leds[i], HIGH);
    <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">digitalWrite</span><span class="hljs-params">(pinos_Leds[i], LOW)</span></span>;
  }
  <span class="hljs-comment">// deixa preparadao para próxima chamada</span>
  led_ativo = led_ativo + dir;
  <span class="hljs-keyword">if</span> (led_ativo &gt;= Leds) {
    led_ativo = Leds-<span class="hljs-number">2</span>;
    dir = -<span class="hljs-number">1</span>;
  }
  <span class="hljs-keyword">if</span> (led_ativo &lt; <span class="hljs-number">0</span>) {
    led_ativo = <span class="hljs-number">1</span>;
    dir = <span class="hljs-number">1</span>;
  }
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init_vars</span><span class="hljs-params">()</span></span>{
  previousMillis = millis();
  generate    = <span class="hljs-keyword">false</span>;
  debouncing  = <span class="hljs-keyword">false</span>;
  blink       = <span class="hljs-keyword">false</span>;
  led_ativo   = <span class="hljs-number">0</span>;
  dir = <span class="hljs-number">1</span>;    <span class="hljs-comment">// direção "movimento" dos leds (+1 ou -1)</span>
  index = <span class="hljs-number">0</span>;  <span class="hljs-comment">// ponto inicial da senoide  </span>
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">update_leds</span><span class="hljs-params">()</span></span>{
  <span class="hljs-comment">// atualiza interface de saida conforme "status" do sistema</span>
  <span class="hljs-keyword">if</span> (currentMillis - previousMillis &gt;= time_wait) {
    <span class="hljs-comment">// save the last time you blinked the LED</span>
    previousMillis = currentMillis;
    <span class="hljs-keyword">if</span> (generate) {
      activate_next_led();
    } 
    <span class="hljs-keyword">else</span> 
    {
      blink = !blink;
      <span class="hljs-keyword">if</span> (blink) turn_on_all_leds();
      <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">turn_off_leds</span><span class="hljs-params">()</span></span>;
    }
  }  
}

<span class="hljs-comment">//  Segue codigo da ISR que gera os pontos da senoide</span>
ISR(TIMER2_COMPA_vect){
  digitalWrite(pino_monitor, HIGH); <span class="hljs-comment">// enters on ISR</span>
  y = <span class="hljs-number">0</span>;  <span class="hljs-comment">// por default, duty-cycle de saída = 0%</span>
  <span class="hljs-keyword">if</span> (generate) {
    theta = index * delta_th;  <span class="hljs-comment">// calcula angulo atual da senoide</span>
    y = <span class="hljs-number">128.0</span> + <span class="hljs-number">128.0</span>*<span class="hljs-built_in">sin</span>(theta);
    index++; <span class="hljs-comment">// deixa pronto para proximo ponto</span>
    <span class="hljs-keyword">if</span> (index &gt; <span class="hljs-number">9</span>) index = <span class="hljs-number">0</span>;
  }
  analogWrite(pino_PWM, y);
  digitalWrite(pino_monitor, LOW);  <span class="hljs-comment">// get out from ISR</span>
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-comment">// put your setup code here, to run once:</span>
  Leds = <span class="hljs-keyword">sizeof</span>(pinos_Leds) / <span class="hljs-keyword">sizeof</span>(byte);
  <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">0</span>; i&lt;Leds; i++){
    pinMode(pinos_Leds[i], OUTPUT);
    digitalWrite(pinos_Leds[i], HIGH);
  }
  pinMode(pino_ESC, INPUT);   <span class="hljs-comment">// botão ESC</span>
  pinMode(pino_PWM, OUTPUT);
  pinMode(pino_monitor, OUTPUT);

  Serial.begin(<span class="hljs-number">9600</span>); <span class="hljs-comment">// depois tentar aumentar para 115 Kbps</span>
  <span class="hljs-comment">// Serial.begin(115200);</span>
  delay(<span class="hljs-number">100</span>);
  Serial.println(<span class="hljs-string">"Setup"</span>);
  Serial.print(<span class="hljs-string">"\tLeds = "</span>); Serial.println(Leds);
  Serial.print(<span class="hljs-string">"\tPI = "</span>); Serial.println(PI);
  Serial.print(<span class="hljs-string">"\tdelta_th = "</span>); Serial.println(delta_th);
  Serial.println(<span class="hljs-string">"\tConfiguring ISR using timer2..."</span>);

  <span class="hljs-comment">// configurando inicialização do timer2 usado para a ISR</span>
  cli();        <span class="hljs-comment">//stop interrupts</span>
  TCCR2A = <span class="hljs-number">0</span>;   <span class="hljs-comment">// set entire TCCR2A register to 0</span>
  TCCR2B = <span class="hljs-number">0</span>;   <span class="hljs-comment">// same for TCCR2B</span>
  TCNT2 = <span class="hljs-number">0</span>;    <span class="hljs-comment">// initialize counter value to 0</span>
  <span class="hljs-comment">// set timer2 interrupt at 400 Hz</span>
  <span class="hljs-comment">// set compare match register for 400 Hz increments:</span>
  OCR2A = <span class="hljs-number">155</span>;  <span class="hljs-comment">// = (16*10^6) / (400*256) - 1 (must be &lt;256)</span>
  <span class="hljs-comment">// set CS prescaler for timer2 to 256 (CS2:0)=6(10)=110(2):</span>
  TCCR2B |= (<span class="hljs-number">1</span> &lt;&lt; CS22) | (<span class="hljs-number">1</span> &lt;&lt; CS21) | (<span class="hljs-number">0</span> &lt;&lt; CS20);
  TCCR2A |= (<span class="hljs-number">1</span> &lt;&lt; WGM21);   <span class="hljs-comment">// turn on CTC mode for timer2</span>
  TIMSK2 |= (<span class="hljs-number">1</span> &lt;&lt; OCIE2A);  <span class="hljs-comment">// enable timer compare interrupt</span>
  sei();                    <span class="hljs-comment">//allow interrupts </span>
  <span class="hljs-comment">// fim configuração ISR</span>

  turn_off_leds();
  init_vars();
  Serial.println(<span class="hljs-string">"Setup done...\n"</span>);
} <span class="hljs-comment">// end setup()</span>

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{
  currentMillis = millis();   <span class="hljs-comment">// atualizando esta variável</span>
  update_leds(); <span class="hljs-comment">// atualiza interface de saída (leds)</span>
  <span class="hljs-comment">// lê botão ESC para alternar gerar/não-generar senoide mas apenas fora do periodo do debouncing</span>
  <span class="hljs-keyword">if</span> (!debouncing) {
    <span class="hljs-keyword">if</span> (digitalRead(pino_ESC) == LOW) {
      <span class="hljs-comment">// deveria deixar passar uns 50 ~ 100 ms a titulo de debouncing do botão</span>
      <span class="hljs-comment">// não podemos usar delay(100) porque influencia função analogWrite() - gerador PWM "interno" do Arduino</span>
      debouncing = <span class="hljs-keyword">true</span>;
      time_pressed = millis();
      generate = !generate;  <span class="hljs-comment">// simplesmente alterna estado</span>
      <span class="hljs-comment">// atualiza info e variaveis para nova condição</span>
      <span class="hljs-keyword">if</span> (generate) {
        index = <span class="hljs-number">0</span>;      <span class="hljs-comment">// reinicia senoide</span>
        Serial.println(<span class="hljs-string">"Generating sine wave..."</span>);
        led_ativo = <span class="hljs-number">0</span>;  <span class="hljs-comment">// reinicia interface de saida</span>
      } <span class="hljs-keyword">else</span> {
        Serial.println(<span class="hljs-string">"NOT generating sine wave (pause)..."</span>);
      }
    }
  }
  <span class="hljs-keyword">if</span> (debouncing) {
    <span class="hljs-comment">// Significa que estamos dentro de periodo de debouncing em que a chave é ignorada</span>
    <span class="hljs-comment">// falta verificar se passou tempo para "desligar" o debouncing</span>
    <span class="hljs-keyword">if</span> (currentMillis - time_pressed &gt;= time_debounce) {
      debouncing = <span class="hljs-keyword">false</span>;  <span class="hljs-comment">// habilita novas leituras do botão</span>
    }
  }
}  <span class="hljs-comment">// end loop()</span>
</code></pre><p>Exemplo de saída gerada no Monitor Serial (9600 baud):</p><pre><code class="text" data-origin="<pre><code class=&quot;text&quot;>17:38:24.949 -&amp;gt; Setup
17:38:24.949 -&amp;gt;  Leds = 3
17:38:24.980 -&amp;gt;  PI = 3.14
17:38:24.980 -&amp;gt;  delta_th = 0.63
17:38:25.012 -&amp;gt;  Configuring ISR using timer2...
17:38:25.054 -&amp;gt; Setup done...
17:38:25.054 -&amp;gt; 
17:38:35.891 -&amp;gt; Generating sine wave...
17:38:35.969 -&amp;gt; y=249.74 led_ativo=0 dir=1
17:38:36.002 -&amp;gt; NOT generating sine wave (pause)...
17:38:37.333 -&amp;gt; Generating sine wave...
17:38:37.488 -&amp;gt; y=203.24 led_ativo=0 dir=1
17:38:37.710 -&amp;gt; y=203.24 led_ativo=1 dir=1
17:38:37.976 -&amp;gt; y=203.24 led_ativo=2 dir=1
17:38:38.240 -&amp;gt; y=203.24 led_ativo=1 dir=-1
17:38:38.460 -&amp;gt; y=203.24 led_ativo=0 dir=-1
17:38:38.721 -&amp;gt; y=203.24 led_ativo=1 dir=1
17:38:38.959 -&amp;gt; y=249.74 led_ativo=2 dir=1
17:38:39.208 -&amp;gt; NOT generating sine wave (pause)...
</code></pre>">17:38:24.949 -&gt; Setup
17:38:24.949 -&gt;  Leds = 3
17:38:24.980 -&gt;  PI = 3.14
17:38:24.980 -&gt;  delta_th = 0.63
17:38:25.012 -&gt;  Configuring ISR using timer2...
17:38:25.054 -&gt; Setup done...
17:38:25.054 -&gt; 
17:38:35.891 -&gt; Generating sine wave...
17:38:35.969 -&gt; y=249.74 led_ativo=0 dir=1
17:38:36.002 -&gt; NOT generating sine wave (pause)...
17:38:37.333 -&gt; Generating sine wave...
17:38:37.488 -&gt; y=203.24 led_ativo=0 dir=1
17:38:37.710 -&gt; y=203.24 led_ativo=1 dir=1
17:38:37.976 -&gt; y=203.24 led_ativo=2 dir=1
17:38:38.240 -&gt; y=203.24 led_ativo=1 dir=-1
17:38:38.460 -&gt; y=203.24 led_ativo=0 dir=-1
17:38:38.721 -&gt; y=203.24 led_ativo=1 dir=1
17:38:38.959 -&gt; y=249.74 led_ativo=2 dir=1
17:38:39.208 -&gt; NOT generating sine wave (pause)...
</code></pre><p>A próxima figura capturada de osciloscópio demostra a onda senoidal gerada na frequência de 40,6 Hz:</p><p><img src="figuras/TEK0029_ed.JPG" alt="TEK0029_red.JPG"></p><p>Na figura anterior, a curva em amarelo ressalta o sinal PWM filtrado, que gera uma onda semelhante à uma senoide. Neste caso, ainda usando C=150 nF no filtro Passa Baixas. E a onda inferior (curva em ciano), mostra a saída do pino 5, usada para monitorar o período de tempo gasto para processar a rotina de ISR.</p><p>De forma a melhorar a filtragem, foi colocado outro capacitor de C=220 nF em paralelo com o anterior, resultando numa capacitância final de <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-92-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1224" style="width: 10.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.533em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.855em 1000em 3.03em -0.43em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-1225"><span class="mi" id="MathJax-Span-1226" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mo" id="MathJax-Span-1227" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1228" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px;"><span style="position: absolute; clip: rect(1.695em 1000em 2.742em -0.43em); top: -2.56em; left: 0em;"><span class="mi" id="MathJax-Span-1229" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span><span style="position: absolute; top: -2.357em; left: 0.755em;"><span class="mn" id="MathJax-Span-1230" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.507em;"></span></span></span></span><span class="mo" id="MathJax-Span-1231" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-1232" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px;"><span style="position: absolute; clip: rect(1.695em 1000em 2.742em -0.43em); top: -2.56em; left: 0em;"><span class="mi" id="MathJax-Span-1233" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span><span style="position: absolute; top: -2.357em; left: 0.755em;"><span class="mn" id="MathJax-Span-1234" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.507em;"></span></span></span></span><span class="mo" id="MathJax-Span-1235" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1236" style="font-family: MathJax_Main; padding-left: 0.278em;">370</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.202em; vertical-align: -0.254em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-92">C=C_1+C_2=370</script></span> nF, o que, juntamente com o resistor de 10 K<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-93-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1237" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.747em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.856em 1000em 2.88em -0.436em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-1238"><span class="mi" id="MathJax-Span-1239" style="font-family: MathJax_Main;">Ω</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-93">\Omega</script></span>, baixou a frequência de corte do filtro de 106,1 Hz para:</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-94-Frame"><nobr><span class="math" id="MathJax-Span-1240" style="width: 22.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.92em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.217em 1000em 3.967em -0.425em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-1241"><span class="msubsup" id="MathJax-Span-1242"><span style="display: inline-block; position: relative; width: 0.922em; height: 0px;"><span style="position: absolute; clip: rect(1.695em 1000em 2.925em -0.425em); top: -2.56em; left: 0em;"><span class="mi" id="MathJax-Span-1243" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span><span style="position: absolute; top: -2.213em; left: 0.527em;"><span class="mi" id="MathJax-Span-1244" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span><span class="mo" id="MathJax-Span-1245" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mstyle" id="MathJax-Span-1246" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-1247"><span class="mfrac" id="MathJax-Span-1248"><span style="display: inline-block; position: relative; width: 2.733em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.894em 1000em 2.88em -0.397em); top: -3.397em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-1249" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; clip: rect(1.855em 1000em 2.902em -0.43em); top: -2.034em; left: 50%; margin-left: -1.307em;"><span class="mrow" id="MathJax-Span-1250"><span class="mn" id="MathJax-Span-1251" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-1252" style="font-family: MathJax_Math; font-style: italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1253" style="font-family: MathJax_Math; font-style: italic;">R</span><span class="mi" id="MathJax-Span-1254" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; clip: rect(0.84em 1000em 1.227em -0.48em); top: -1.287em; left: 0em;"><span style="border-left-width: 2.733em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.067em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1255" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mstyle" id="MathJax-Span-1256" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-1257"><span class="mfrac" id="MathJax-Span-1258"><span style="display: inline-block; position: relative; width: 11.16em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.894em 1000em 2.88em -0.397em); top: -3.397em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-1259" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; clip: rect(1.696em 1000em 3.13em -0.43em); top: -1.883em; left: 50%; margin-left: -5.52em;"><span class="mrow" id="MathJax-Span-1260"><span class="mn" id="MathJax-Span-1261" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-1262" style="font-family: MathJax_Math; font-style: italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1263" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1264" style="font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-1265" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="msubsup" id="MathJax-Span-1266" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.462em; height: 0px;"><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.397em); top: -2.72em; left: 0em;"><span class="mn" id="MathJax-Span-1267" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; top: -2.9em; left: 1.013em;"><span class="mn" id="MathJax-Span-1268" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 2.507em;"></span></span></span></span><span class="mo" id="MathJax-Span-1269" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1270" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1271" style="font-family: MathJax_Main;">370</span><span class="mo" id="MathJax-Span-1272" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="msubsup" id="MathJax-Span-1273" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.995em; height: 0px;"><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.397em); top: -2.72em; left: 0em;"><span class="mn" id="MathJax-Span-1274" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; top: -2.9em; left: 1.013em;"><span class="texatom" id="MathJax-Span-1275"><span class="mrow" id="MathJax-Span-1276"><span class="mo" id="MathJax-Span-1277" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1278" style="font-size: 70.7%; font-family: MathJax_Main;">9</span></span></span><span style="display: inline-block; width: 0px; height: 2.507em;"></span></span></span></span><span class="mo" id="MathJax-Span-1279" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; clip: rect(0.84em 1000em 1.227em -0.48em); top: -1.287em; left: 0em;"><span style="border-left-width: 11.16em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.067em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.171em; vertical-align: -1.426em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-94">
f_c=\dfrac{1}{2\pi RC}=\dfrac{1}{2\pi(10\times 10^3)(370 \times 10^{-9})}</script><p></p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-95-Frame"><nobr><span class="math" id="MathJax-Span-1280" style="width: 8.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.667em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.855em 1000em 3.128em -0.425em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-1281"><span class="msubsup" id="MathJax-Span-1282"><span style="display: inline-block; position: relative; width: 0.922em; height: 0px;"><span style="position: absolute; clip: rect(1.695em 1000em 2.925em -0.425em); top: -2.56em; left: 0em;"><span class="mi" id="MathJax-Span-1283" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span><span style="position: absolute; top: -2.213em; left: 0.527em;"><span class="mi" id="MathJax-Span-1284" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span><span class="mo" id="MathJax-Span-1285" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1286" style="font-family: MathJax_Main; padding-left: 0.278em;">43</span><span class="mo" id="MathJax-Span-1287" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1288" style="font-family: MathJax_Main; padding-left: 0.167em;">015</span><span class="mtext" id="MathJax-Span-1289" style="font-family: MathJax_Main;">&nbsp;Hz</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.325em; vertical-align: -0.377em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-95">
f_c=43,015\text{ Hz}</script><p></p><p>Resultando num sinal um pouco mais “suave”:</p><p><img src="figuras/TEK0043_ed.JPG" alt="TEK0043_red.JPG"></p><p>A próxima figura mostra a relação entre o sinal PWM filtrado (curva superior, em amarelo) e o sinal PWM bruto (curva inferior, em ciano):</p><p><img src="figuras/TEK0037_ed.JPG" alt="TEK0037_red.JPG"></p><p>Note como seu duty-cycle varia conforme o ponto da senoide sendo sintetizado.</p><p>Um “zoom” sobre a figura anteior permite perceber um pouco melhor como a onda senoidal é gerada:</p><p><img src="figuras/TEK0038_ed.JPG" alt="TEK0038_red.JPG"></p><p>A próxima figura, destaca o tempo de processamento gasto pela rotina de ISR</p><p><img src="figuras/TEK0046_ed.JPG" alt="TEK0046_red.JPG"></p><p>Algumas medições foram realizadas e um dos maiores valores registrados para o período de tempo em que o pino 5 (monitor) permanece em nível lógico ALTO (Arduíno processando a ISR) foi de 166,9 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-96-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1290" style="width: 0.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.64em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.958em 1000em 2.936em -0.457em); top: -2.56em; left: 0em;"><span class="mrow" id="MathJax-Span-1291"><span class="mi" id="MathJax-Span-1292" style="font-family: MathJax_Math; font-style: italic;">μ</span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.956em; vertical-align: -0.337em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-96">\mu</script></span>s (na média era gasto 159,8 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-97-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1293" style="width: 0.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.64em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.958em 1000em 2.936em -0.457em); top: -2.56em; left: 0em;"><span class="mrow" id="MathJax-Span-1294"><span class="mi" id="MathJax-Span-1295" style="font-family: MathJax_Math; font-style: italic;">μ</span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.956em; vertical-align: -0.337em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-97">\mu</script></span>s). Note que as medições comprovam que a frequência da ISR ficou entre 400 e 403 Hz (<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-98-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1296" style="width: 9.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.307em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.81em 1000em 3.13em -0.459em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-1297"><span class="mi" id="MathJax-Span-1298" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span class="mo" id="MathJax-Span-1299" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1300" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-1301"><span class="mrow" id="MathJax-Span-1302"><span class="mo" id="MathJax-Span-1303" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-1304" style="font-family: MathJax_Main;">400</span><span class="mo" id="MathJax-Span-1305" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1306" style="font-family: MathJax_Main; padding-left: 0.278em;">2</span><span class="mo" id="MathJax-Span-1307" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1308" style="font-family: MathJax_Main; padding-left: 0.167em;">5</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.383em; vertical-align: -0.379em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-98">T=1/400=2,5</script></span> ms). Isto permite concluir que a rotina ISR ocupou <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-99-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1309" style="width: 16.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.227em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.02em 1000em 3.739em -0.48em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-1310"><span class="mstyle" id="MathJax-Span-1311"><span class="mrow" id="MathJax-Span-1312"><span class="mfrac" id="MathJax-Span-1313"><span style="display: inline-block; position: relative; width: 5.347em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.696em 1000em 2.902em -0.397em); top: -3.397em; left: 50%; margin-left: -2.373em;"><span class="mrow" id="MathJax-Span-1314"><span class="mn" id="MathJax-Span-1315" style="font-family: MathJax_Main;">167</span><span class="mo" id="MathJax-Span-1316" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="msubsup" id="MathJax-Span-1317" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.995em; height: 0px;"><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.397em); top: -2.72em; left: 0em;"><span class="mn" id="MathJax-Span-1318" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; top: -2.9em; left: 1.013em;"><span class="texatom" id="MathJax-Span-1319"><span class="mrow" id="MathJax-Span-1320"><span class="mo" id="MathJax-Span-1321" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1322" style="font-size: 70.7%; font-family: MathJax_Main;">6</span></span></span><span style="display: inline-block; width: 0px; height: 2.507em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; clip: rect(1.696em 1000em 2.902em -0.43em); top: -1.883em; left: 50%; margin-left: -2.613em;"><span class="mrow" id="MathJax-Span-1323"><span class="mn" id="MathJax-Span-1324" style="font-family: MathJax_Main;">2500</span><span class="mo" id="MathJax-Span-1325" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="msubsup" id="MathJax-Span-1326" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.995em; height: 0px;"><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.397em); top: -2.72em; left: 0em;"><span class="mn" id="MathJax-Span-1327" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; top: -2.9em; left: 1.013em;"><span class="texatom" id="MathJax-Span-1328"><span class="mrow" id="MathJax-Span-1329"><span class="mo" id="MathJax-Span-1330" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1331" style="font-size: 70.7%; font-family: MathJax_Main;">6</span></span></span><span style="display: inline-block; width: 0px; height: 2.507em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; clip: rect(0.84em 1000em 1.227em -0.48em); top: -1.287em; left: 0em;"><span style="border-left-width: 5.347em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.067em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1332" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mn" id="MathJax-Span-1333" style="font-family: MathJax_Main; padding-left: 0.222em;">100</span><span class="mi" id="MathJax-Span-1334" style="font-family: MathJax_Main;">%</span><span class="mo" id="MathJax-Span-1335" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1336" style="font-family: MathJax_Main; padding-left: 0.278em;">6</span><span class="mo" id="MathJax-Span-1337" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1338" style="font-family: MathJax_Main; padding-left: 0.167em;">68</span><span class="mi" id="MathJax-Span-1339" style="font-family: MathJax_Main;">%</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.133em; vertical-align: -1.141em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-99">\dfrac{167\times 10^{-6}}{2500 \times 10^{-6}} \times 100\% = 6,68\%</script></span> da frequência selecionada para esta ISR.</p><p>Isto significa que o Arduíno “gastou”: 167 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-100-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1340" style="width: 0.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.64em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.958em 1000em 2.936em -0.457em); top: -2.56em; left: 0em;"><span class="mrow" id="MathJax-Span-1341"><span class="mi" id="MathJax-Span-1342" style="font-family: MathJax_Math; font-style: italic;">μ</span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.956em; vertical-align: -0.337em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-100">\mu</script></span>s para realizar 2 adições <em>float</em> + 2 multiplicações <em>float</em> + 1 cálculo de seno (em <em>float</em>) quando operado à 16 MHz (<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-101-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1343" style="width: 17.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.92em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.696em 1000em 3.13em -0.459em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-1344"><span class="mi" id="MathJax-Span-1345" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span class="mo" id="MathJax-Span-1346" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1347" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-1348"><span class="mrow" id="MathJax-Span-1349"><span class="mo" id="MathJax-Span-1350" style="font-family: MathJax_Main;">/</span></span></span><span class="mo" id="MathJax-Span-1351" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1352" style="font-family: MathJax_Main;">16</span><span class="mo" id="MathJax-Span-1353" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="msubsup" id="MathJax-Span-1354" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.462em; height: 0px;"><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.397em); top: -2.72em; left: 0em;"><span class="mn" id="MathJax-Span-1355" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; top: -2.9em; left: 1.013em;"><span class="mn" id="MathJax-Span-1356" style="font-size: 70.7%; font-family: MathJax_Main;">6</span><span style="display: inline-block; width: 0px; height: 2.507em;"></span></span></span></span><span class="mo" id="MathJax-Span-1357" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1358" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1359" style="font-family: MathJax_Main; padding-left: 0.278em;">62</span><span class="mo" id="MathJax-Span-1360" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1361" style="font-family: MathJax_Main; padding-left: 0.167em;">5</span><span class="mo" id="MathJax-Span-1362" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="msubsup" id="MathJax-Span-1363" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.995em; height: 0px;"><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.397em); top: -2.72em; left: 0em;"><span class="mn" id="MathJax-Span-1364" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; top: -2.9em; left: 1.013em;"><span class="texatom" id="MathJax-Span-1365"><span class="mrow" id="MathJax-Span-1366"><span class="mo" id="MathJax-Span-1367" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1368" style="font-size: 70.7%; font-family: MathJax_Main;">9</span></span></span><span style="display: inline-block; width: 0px; height: 2.507em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.526em; vertical-align: -0.379em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-101">T=1/(16 \times 10^6)=62,5 \times 10^{-9}</script></span> = 62,5 ns), ou aproximadamente <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-102-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1369" style="width: 20.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.747em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.696em 1000em 3.13em -0.386em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-1370"><span class="mo" id="MathJax-Span-1371" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1372" style="font-family: MathJax_Main;">167000</span><span class="mo" id="MathJax-Span-1373" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="msubsup" id="MathJax-Span-1374" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.995em; height: 0px;"><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.397em); top: -2.72em; left: 0em;"><span class="mn" id="MathJax-Span-1375" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; top: -2.9em; left: 1.013em;"><span class="texatom" id="MathJax-Span-1376"><span class="mrow" id="MathJax-Span-1377"><span class="mo" id="MathJax-Span-1378" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1379" style="font-size: 70.7%; font-family: MathJax_Main;">9</span></span></span><span style="display: inline-block; width: 0px; height: 2.507em;"></span></span></span></span><span class="mo" id="MathJax-Span-1380" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1381"><span class="mrow" id="MathJax-Span-1382"><span class="mo" id="MathJax-Span-1383" style="font-family: MathJax_Main;">/</span></span></span><span class="mo" id="MathJax-Span-1384" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1385" style="font-family: MathJax_Main;">62</span><span class="mo" id="MathJax-Span-1386" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1387" style="font-family: MathJax_Main; padding-left: 0.167em;">5</span><span class="mo" id="MathJax-Span-1388" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="msubsup" id="MathJax-Span-1389" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.995em; height: 0px;"><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.397em); top: -2.72em; left: 0em;"><span class="mn" id="MathJax-Span-1390" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span><span style="position: absolute; top: -2.9em; left: 1.013em;"><span class="texatom" id="MathJax-Span-1391"><span class="mrow" id="MathJax-Span-1392"><span class="mo" id="MathJax-Span-1393" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1394" style="font-size: 70.7%; font-family: MathJax_Main;">9</span></span></span><span style="display: inline-block; width: 0px; height: 2.507em;"></span></span></span></span><span class="mo" id="MathJax-Span-1395" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1396" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1397" style="font-family: MathJax_Main; padding-left: 0.278em;">2672</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.526em; vertical-align: -0.379em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-102">(167000 \times 10^{-9})/(62,5 \times 10^{-9})=2672</script></span> ciclos de clock para realizar estes cálculos.</p><p><strong>Observação final</strong>: uma senóide bem menos ruidosa poderia ser obtida se o PWM do Arduíno oscilasse numa frequência muito superior à naturalmente adotada para a função <code>analogWrite()</code> usada para gerar os próprios pontos da senóide. Em números um bom valor seria uma frequência <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-103-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1398" style="width: 2.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.027em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.894em 1000em 2.902em -0.397em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-1399"><span class="mn" id="MathJax-Span-1400" style="font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-1401" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-103">10 \times</script></span> maior que a frequência usada para amostrar a senóide, ou <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-104-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1402" style="width: 11.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.44em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.855em 1000em 3.136em -0.425em); top: -2.72em; left: 0em;"><span class="mrow" id="MathJax-Span-1403"><span class="msubsup" id="MathJax-Span-1404"><span style="display: inline-block; position: relative; width: 2.575em; height: 0px;"><span style="position: absolute; clip: rect(1.695em 1000em 2.925em -0.425em); top: -2.56em; left: 0em;"><span class="mi" id="MathJax-Span-1405" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.56em;"></span></span><span style="position: absolute; top: -2.213em; left: 0.527em;"><span class="texatom" id="MathJax-Span-1406"><span class="mrow" id="MathJax-Span-1407"><span class="mi" id="MathJax-Span-1408" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mi" id="MathJax-Span-1409" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.074em;"></span></span><span class="mi" id="MathJax-Span-1410" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span><span class="mo" id="MathJax-Span-1411" style="font-family: MathJax_Main; padding-left: 0.278em;">≥</span><span class="mn" id="MathJax-Span-1412" style="font-family: MathJax_Main; padding-left: 0.278em;">10</span><span class="mo" id="MathJax-Span-1413" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mn" id="MathJax-Span-1414" style="font-family: MathJax_Main; padding-left: 0.222em;">400</span><span class="mo" id="MathJax-Span-1415" style="font-family: MathJax_Main; padding-left: 0.278em;">≥</span><span class="mn" id="MathJax-Span-1416" style="font-family: MathJax_Main; padding-left: 0.278em;">4</span></span><span style="display: inline-block; width: 0px; height: 2.72em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.334em; vertical-align: -0.387em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-104">f_{PWM} \ge 10 \times 400 \ge 4</script></span> KHz, mas isto, implicaria recriar esta função, e a ideia aqui era testar que resultado poderia ser obtido com o PWM que “vêm de fábrica” com a IDE do Arduíno.</p><p><a href="https://youtu.be/vVXIK1xCRpY">Fim</a></p><hr class="section"><font size="1">Fernando Passold, em 10/11/2022, 14/11/2022, 15/11/2022, 16/11/2022.</font>

<footer style="position:fixed; font-size:.8em; text-align:right; bottom:0px; margin-left:-25px; height:20px; width:100%;">generated by <a href="http://pad.haroopress.com" target="_blank">haroopad</a></footer>
</body>
</html>
